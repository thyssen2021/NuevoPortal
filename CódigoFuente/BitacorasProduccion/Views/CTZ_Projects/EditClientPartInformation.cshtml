@model Portal_2_0.Models.CTZ_Projects

@{
    ViewBag.Title = "Edit Client & Part Information";
    ViewBag.PrimerNivel = "quote";
    ViewBag.SegundoNivel = "edit_client_part";
    ViewBag.ControllerName = ViewContext.RouteData.Values["controller"];
    ViewBag.nav_style = "nav-sm";

    // Captura la bandera desde el controlador
    bool isDetailsMode = ViewBag.IsDetailsMode as bool? ?? false;

    // Opcional: Cambia el título de la página si está en modo detalles
    if (isDetailsMode)
    {
        ViewBag.Title = "Details - Client & Part Information";
    }

    // ¡CLAVE! Combina los permisos con el modo de detalles.
    // Si isDetailsMode es true, todos los permisos de edición se volverán false.
    bool canEditSales = (ViewBag.CanEditSales as bool? ?? false) && !isDetailsMode;
    bool canEditDataManagement = (ViewBag.CanEditDataManagement as bool? ?? false) && !isDetailsMode;
    bool canEditEngineering = (ViewBag.CanEditEngineering as bool? ?? false) && !isDetailsMode;


}

@section estilos {
    <!-- SweetAlert2 -->
    <link href="@Url.Content("~/Content/vendors/sweetalert2-theme-bootstrap-4/bootstrap-4.min.css")" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" rel="stylesheet" />
    <!-- Select2 -->
    <link href="@Url.Content("~/Content/vendors/select2/css/select2.css")" rel="stylesheet" />
    <link href="@Url.Content("~/Content/vendors/select2-bootstrap4-theme/select2-bootstrap4.min.css")" rel="stylesheet" />
    <!-- DatePicker -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css" />
    <!--Handsontable -->
    <link href="https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.css" rel="stylesheet">

    <style>
        .toast {
            opacity: 0.95 !important; /* Ajusta el valor según lo que necesites */
        }

        /* Contenedor que separa claramente la sección de inputs */
        .material-form {
            border: 2px solid #009ff5; /* Borde con color corporativo */
            border-radius: 6px;
            padding: 15px;
            background-color: #f9fcff; /* Color de fondo claro para distinguir */
            margin-bottom: 30px; /* Separación de la tabla */
        }

        .material-form-title {
            color: #009ff5;
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 10px;
        }

        .material-form label {
            font-weight: bold;
            color: #009ff5; /* Resaltamos el texto del label con color corporativo */
        }

        .material-form .form-control {
            margin-bottom: 10px;
        }

        /* Ajustes generales de la tabla */
        .ht-like {
            border-collapse: collapse;
            width: 100%;
            border: 1px solid #ccc; /* Borde exterior */
            font-family: Arial, sans-serif; /* fuente similar a Handsontable */
        }

            /* Cabecera de la tabla */
            .ht-like thead th {
                background-color: #009ff5; /* color de fondo similar a Handsontable */
                color: #fff; /* texto en blanco */
                padding: 8px; /* algo de espaciado */
                border: 1px solid #ccc; /* bordes */
                text-align: center; /* alineación */
            }

            /* Filas del cuerpo */
            .ht-like tbody tr td {
                border: 1px solid #ccc;
                padding: 6px;
            }

            /* Alternar color de fondo en filas (opcional) */
            .ht-like tbody tr:nth-child(even) {
                background-color: #f9f9f9;
            }

            /* Hover en filas (opcional) */
            .ht-like tbody tr:hover {
                background-color: #e6ffe6;
            }

        /* Botón pequeño */
        .btn-xs {
            padding: 5px 10px;
            font-size: 12px;
        }

        input::placeholder {
            color: #bebbbb !important;
        }

        .btn-default {
            background-color: #f4f4f4;
            border: 1px solid #ccc;
            color: #555;
            border-radius: 3px;
            padding: 8px 15px;
        }

        /* Estilos personalizados para el tooltip */
        .tooltip-inner {
            background-color: #009ff5;
            color: #ffffff;
            font-weight: 500;
            border-radius: 4px;
            padding: 8px 12px;
            font-size: 14px;
        }

        .tooltip.bs-tooltip-top .tooltip-arrow::before {
            border-top-color: #009ff5;
        }

        .tooltip.bs-tooltip-bottom .tooltip-arrow::before {
            border-bottom-color: #009ff5;
        }

        .arrow::before {
            border-left-color: #009ff5 !important;
            border-right-color: #009ff5 !important;
        }

        bs-tooltip-right .arrow::before {
        }

        /* Estilos para agrupar secciones */
        fieldset {
            border: 1px solid #ccc;
            border-radius: 5px;
            margin-bottom: 20px;
            padding: 15px;
            background-color: #f9f9f9;
        }

        legend {
            font-size: 1.2em;
            font-weight: bold;
            width: auto;
            padding: 0 10px;
            color: #009ff5;
            margin-bottom: 10px;
        }

        /* Título general del formulario */
        .material-form-title {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 20px;
            color: #009ff5;
        }

        /* Ejemplo de estilos para inputs */
        input.form-control, select.form-control, textarea.form-control {
            border-radius: 3px;
            border: 1px solid #ddd;
            padding: 8px;
            background-color: #fff;
            transition: border-color 0.3s ease;
        }

            input.form-control:focus, select.form-control:focus, textarea.form-control:focus {
                border-color: #009ff5;
                outline: none;
            }

        /* Opcional: estilos para mensajes de error */
        .error-message {
            font-size: 0.9em;
        }

        /* Espaciado entre filas */
        .row + .row {
            margin-top: 15px;
        }

        #archivo, #packaging_archivo, #AdditionalFile, #technicalSheetFile, #arrivalAdditionalFile,
        #coilDataAdditionalFile, #slitterDataAdditionalFile, #volumeAdditionalFile, #outboundFreightAdditionalFile, #deliveryPackagingAdditionalFile {
            display: block;
            width: 100%;
            padding: 10px 12px;
            font-size: 14px;
            color: #555;
            background-color: #f9f9f9;
            border: 1px solid #ccc;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

            #archivo:hover {
                background-color: #eaeaea;
            }

        #downloadFile, #downloadPackagingFile, #downloadFileTechnicalSheetFile, #downloadFileAdditional, #downloadArrivalAdditionalFile,
        #downloadCoilDataAdditionalFile, #downloadSlitterDataAdditionalFile, #downloadVolumeAdditionalFile, #downloadOutboundFreightAdditionalFile, #downloadDeliveryPackagingAdditionalFile {
            display: inline-block;
            background-color: #28a745;
            color: white;
            padding: 5px 12px;
            text-decoration: none;
            border-radius: 4px;
            font-size: 14px;
        }

            #downloadFile:hover {
                background-color: #218838;
            }

        .truncate-filename {
            display: inline-block; /* Permite que max-width funcione en un enlace <a> */
            max-width: 200px; /* Ancho máximo. ¡Puedes ajustar este valor! */
            white-space: nowrap; /* Evita que el texto salte a la siguiente línea */
            overflow: hidden; /* Oculta el texto que se desborda */
            text-overflow: ellipsis; /* ¡La magia! Añade los "..." */
            vertical-align: middle; /* Alinea verticalmente con los botones de al lado */
        }

        /* Texto en gris oscuro cuando está disabled */
        .select2-container--default.select2-container--disabled .select2-selection__rendered {
            color: #7d848a !important;
        }

        /* Opcional: flecha también en gris oscuro */
        .select2-container--default.select2-container--disabled .select2-selection__arrow b {
            border-color: #7d848a transparent transparent transparent !important;
        }

        #shiftLegend {
            border: solid 1px gray;
            padding-top: 8px;
            padding-bottom: 8px;
            display: none;
        }

            #shiftLegend .legend-item {
                display: inline-block;
                margin: 0 20px;
                font-size: 0.9em;
                color: #333;
            }

            #shiftLegend .legend-line {
                display: inline-block;
                width: 30px;
                height: 0;
                border-top: 2px dashed;
                margin-right: 6px;
                vertical-align: middle;
            }
        /* --- INICIO DE ESTILOS PARA PACKAGING (VERSIÓN FINAL) --- */
        .packaging-row {
            display: flex;
            flex-wrap: wrap;
        }

        .checkbox-group-container {
            display: flex; /* Permite que el contenedor se estire verticalmente */
            flex-direction: column;
        }

        .group-content-wrapper {
            border: 1px solid #ced4da;
            border-radius: .25rem;
            background-color: #fff;
            display: flex;
            flex-direction: column;
            flex-grow: 1; /* ¡CLAVE! Hace que este recuadro ocupe toda la altura de su columna. */
        }

        .checkbox-options-wrapper {
            padding: 10px;
            overflow-y: auto;
            /* QUITAMOS cualquier altura fija o mínima para que sea flexible */
        }

        .other-description-wrapper {
            padding: 0 10px 10px 10px;
            margin-top: auto; /* ¡MAGIA! Empuja el textarea hacia el fondo. */
            border-top: 1px solid #eee;
            padding-top: 8px;
        }

        /* Estilos para que los elementos se vean bien (sin cambios) */
        .observation-label {
            font-size: 0.8em;
            color: #6c757d;
            margin-bottom: 2px;
            font-weight: normal;
        }

        .form-check-label {
            color: #495057;
            font-weight: normal;
        }

        .limit-display {
            display: block; /* Para que ocupe su propia línea debajo del input */
            margin-top: 5px;
            font-size: 12px;
            font-style: italic;
            color: #009ff5 !important; /* Usamos tu color corporativo */
            height: 15px; /* Altura fija para que no mueva el layout */
        }
        /* --- FIN DE ESTILOS PARA PACKAGING --- */
        /* --- INICIO: Agrega estos nuevos estilos --- */
        .slitting-rule-warning {
            border-top: 3px solid #dc3545; /* Línea superior roja */
            background-color: #fef4f4; /* Fondo rojo muy claro */
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 4px;
        }

            /* Texto principal del error */
            .slitting-rule-warning .error-text {
                color: #dc3545; /* Texto rojo */
                font-weight: 500;
                margin: 0 0 8px 0;
            }

            /* Contenedor de la tabla: quitamos la altura máxima y el scroll */
            .slitting-rule-warning .rules-table-wrapper {
                /* No se necesita ninguna regla aquí ahora */
            }

            /* Celdas de la tabla: las hacemos más compactas */
            .slitting-rule-warning .table th,
            .slitting-rule-warning .table td {
                padding: 0.25rem 0.5rem; /* Reduce el espaciado vertical y horizontal */
                font-size: 0.8rem; /* Hace la fuente un poco más pequeña */
                vertical-align: middle;
            }
        /* --- FIN DE LOS NUEVOS ESTILOS --- */
        .label-non-functional {
            color: #dc3545 !important; /* Un color rojo estándar de Bootstrap para peligro/advertencia */
            font-weight: bold;
        }

        /* --- ESTILOS PARA CHECKBOX PERSONALIZADO --- */
        .custom-checkbox-container {
            display: flex;
            align-items: center; /* Centra verticalmente el checkbox con el texto */
            position: relative;
            cursor: pointer;
            user-select: none; /* Evita que el texto se seleccione al hacer clic */
        }

            /* Oculta el checkbox original del navegador */
            .custom-checkbox-container .form-check-input {
                opacity: 0;
                cursor: pointer;
                height: 0;
                width: 0;
            }

            /* Crea el nuevo recuadro del checkbox */
            .custom-checkbox-container .form-check-label::before {
                content: '';
                display: inline-block;
                width: 20px; /* Ancho del nuevo checkbox */
                height: 20px; /* Alto del nuevo checkbox */
                margin-right: 10px;
                border: 2px solid #009ff5; /* Borde con tu color corporativo */
                border-radius: 3px;
                background-color: white;
                vertical-align: middle; /* Alineación con el texto */
            }

            /* Estilo del recuadro cuando el checkbox está seleccionado */
            .custom-checkbox-container .form-check-input:checked + .form-check-label::before {
                background-color: #009ff5; /* Fondo azul al seleccionar */
                border-color: #007fcc; /* Borde más oscuro */
            }

        /* --- ESTILOS PARA CHECKBOX PERSONALIZADO --- */
        .custom-checkbox-container {
            display: flex;
            align-items: center; /* Centra verticalmente el checkbox con el texto */
            position: relative;
            cursor: pointer;
            user-select: none; /* Evita que el texto se seleccione al hacer clic */
        }

            /* Oculta el checkbox original del navegador */
            .custom-checkbox-container .form-check-input {
                opacity: 0;
                cursor: pointer;
                height: 0;
                width: 0;
            }

            /* Haz que la etiqueta sea el punto de referencia para la palomita */
            .custom-checkbox-container .form-check-label {
                position: relative;
                padding-left: 0px; /* Pequeño ajuste para que no esté pegado al borde */
            }
                /* Crea la forma de "L" para la palomita (inicialmente oculta) */
                .custom-checkbox-container .form-check-label::after {
                    content: '';
                    position: absolute;
                    display: none;
                    left: 7px; /* Posición X dentro del recuadro */
                    top: 4px; /* Posición Y dentro del recuadro */
                    width: 6px;
                    height: 12px;
                    border: solid white;
                    border-width: 0 3px 3px 0;
                    transform: rotate(45deg); /* ¡La magia! Rota la "L" para formar la palomita */
                }

            /* Muestra la palomita cuando el checkbox está seleccionado */
            .custom-checkbox-container .form-check-input:checked + .form-check-label::after {
                display: block;
            }

        .field-warning-text {
            display: none; /* Oculto por defecto */
            color: #fd7e14; /* Color naranja para advertencias */
            font-size: 0.85em;
            font-style: italic;
            margin-top: 5px;
        }
    </style>
}

<div class="right_col" role="main">
    <div class="">
        <div class="clearfix"></div>
        <div class="row">
            <div class="col-md-12 col-sm-12">
                <fieldset class="x_panel">
                    <div class="x_title">
                        <h2>@ViewBag.Title @isDetailsMode</h2>
                        <div class="clearfix"></div>
                    </div>
                    <div class="x_content">
                        <!-- Cuadro informativo con los datos del proyecto -->
                        @{
                            // Si quieres ocultar el botón "Edit General Data":
                            ViewBag.ShowEditButton = false;
                        }
                        @Html.Partial("_CTZ_ProjectInfoCurrent", Model)

                        <!-- Form principal -->
                        @using (Html.BeginForm("EditClientPartInformation", "CTZ_Projects", FormMethod.Post, new { enctype = "multipart/form-data", id = "materialForm" }))
                        {
                            @Html.AntiForgeryToken()

                            if (!Html.ViewData.ModelState.IsValid)
                            {
                                <div class="alert alert-danger" role="alert">
                                    @Html.ValidationSummary("", "Advertencia:")
                                </div>
                            }

                            <!-- Hidden para el ID del proyecto -->
                            @Html.HiddenFor(model => model.ID_Project)

                            <!-- TITLE FOR THE MATERIAL FORM -->
                            <div class="material-form-title">Summary Parts Number</div>
                            <!-- TABLA DE MATERIALES -->
                            <table class="table-responsive ht-like" id="materialsTable">
                                <thead>
                                    <tr>
                                        <th nowrap>Actions</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Vehicle)</th>
                                        <th nowrap>Vehicle Version</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().SOP_SP)</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().EOP_SP)</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Real_SOP)</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Real_EOP)</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Ship_To)</th>
                                        <th nowrap>Part Name</th>
                                        <th nowrap>Part Number</th>
                                        <th nowrap>Quality</th>
                                        <th nowrap>Program SP</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Max_Production_SP)</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Annual_Volume)</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Volume_Per_year)</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_Route)</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Tensile_Strenght)</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_Material_type)</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Thickness)</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Width)</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Pitch)</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Blanks_Per_Stroke)</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Parts_Per_Vehicle)</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Theoretical_Gross_Weight)</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Gross_Weight)</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_Shape)</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Angle_A)</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Angle_B)</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_Theoretical_Blanking_Line)</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_Real_Blanking_Line)</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Theoretical_Strokes)</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Real_Strokes)</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Ideal_Cycle_Time_Per_Tool)</th>
                                        <th nowrap>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().OEE)</th>
                                        <th nowrap>Status DM</th>
                                        <th nowrap>Status DM Comment</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @if (Model.CTZ_Project_Materials != null && Model.CTZ_Project_Materials.Any())
                                    {
                                        var matList = Model.CTZ_Project_Materials.OrderByDescending(x => x.ID_Material).ToList();
                                        for (int i = 0; i < matList.Count; i++)
                                        {
                                            var material = matList[i];
                                            <tr data-index="@i" data-material-id="@material.ID_Material">
                                                <td nowrap>
                                                    @if (isDetailsMode)
                                                    {
                                                        <button type="button" class="btn btn-info btn-xs details-row">Details</button>
                                                    }
                                                    else
                                                    {
                                                        <button type="button" class="btn btn-warning btn-xs edit-row">Edit</button>
                                                    }

                                                    @if (canEditSales)
                                                    {
                                                        <button type="button" class="btn btn-info btn-xs copy-row">Copy</button>
                                                        <button type="button" class="btn btn-danger btn-xs remove-row">Remove</button>
                                                    }
                                                    <!-- Hidden inputs para el POST -->
                                                    <input type="hidden" name="materials[@i].ID_Material" value="@material.ID_Material" />
                                                    <input type="hidden" name="materials[@i].Vehicle" value="@material.Vehicle" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Vehicle_2))" value="@material.Vehicle_2" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Vehicle_3))" value="@material.Vehicle_3" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Vehicle_4))" value="@material.Vehicle_4" />
                                                    <input type="hidden" name="materials[@i].Vehicle_version" value="@material.Vehicle_version" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.SOP_SP))" value="@(material.SOP_SP.HasValue? material.SOP_SP.Value.ToString("yyyy-MM"):"")" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.EOP_SP))" value="@(material.EOP_SP.HasValue? material.EOP_SP.Value.ToString("yyyy-MM"):"")" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Real_SOP))" value="@(material.Real_SOP.HasValue? material.Real_SOP.Value.ToString("yyyy-MM"):"")" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Real_EOP))" value="@(material.Real_EOP.HasValue? material.Real_EOP.Value.ToString("yyyy-MM"):"")" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Ship_To))" value="@(material.Ship_To)" />
                                                    <input type="hidden" name="materials[@i].Part_Number" value="@material.Part_Number" />
                                                    <input type="hidden" name="materials[@i].Part_Name" value="@material.Part_Name" />
                                                    <input type="hidden" name="materials[@i].Quality" value="@material.Quality" />
                                                    <input type="hidden" name="materials[@i].Program_SP" value="@material.Program_SP" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Max_Production_SP))" value="@material.Max_Production_SP" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Annual_Volume))" value="@material.Annual_Volume" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Volume_Per_year))" value="@material.Volume_Per_year" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Route))" value="@material.ID_Route" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Tensile_Strenght))" value="@material.Tensile_Strenght" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Material_type))" value="@material.ID_Material_type" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Thickness))" value="@material.Thickness" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width))" value="@material.Width" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Pitch))" value="@material.Pitch" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Blanks_Per_Stroke))" value="@material.Blanks_Per_Stroke" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Parts_Per_Vehicle))" value="@material.Parts_Per_Vehicle" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Theoretical_Gross_Weight))" value="@material.Theoretical_Gross_Weight" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Gross_Weight))" value="@material.Gross_Weight" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Shape))" value="@material.ID_Shape" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Angle_A))" value="@material.Angle_A" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Angle_B))" value="@material.Angle_B" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Real_Blanking_Line))" value="@material.ID_Real_Blanking_Line" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Theoretical_Blanking_Line))" value="@material.ID_Theoretical_Blanking_Line" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Theoretical_Strokes))" value="@material.Theoretical_Strokes" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Real_Strokes))" value="@material.Real_Strokes" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Ideal_Cycle_Time_Per_Tool))" value="@material.Ideal_Cycle_Time_Per_Tool" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.OEE))" value="@material.OEE" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.TonsPerShift))" value="@material.TonsPerShift" />
                                                    <input type="hidden" name="materials[@i].DM_status" data-material-id="@material.ID_Material" value="@material.DM_status" />
                                                    <input type="hidden" name="materials[@i].DM_status_comment" data-material-id="@material.ID_Material" value="@material.DM_status_comment" />
                                                    <!--Nuevos Campos -->
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ThicknessToleranceNegative))" value="@material.ThicknessToleranceNegative" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ThicknessTolerancePositive))" value="@material.ThicknessTolerancePositive" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.WidthToleranceNegative))" value="@material.WidthToleranceNegative" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.WidthTolerancePositive))" value="@material.WidthTolerancePositive" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.PitchToleranceNegative))" value="@material.PitchToleranceNegative" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.PitchTolerancePositive))" value="@material.PitchTolerancePositive" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.AngleAToleranceNegative))" value="@material.AngleAToleranceNegative" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.AngleATolerancePositive))" value="@material.AngleATolerancePositive" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.AngleBToleranceNegative))" value="@material.AngleBToleranceNegative" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.AngleBTolerancePositive))" value="@material.AngleBTolerancePositive" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Multipliers))" value="@material.Multipliers" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MajorBase))" value="@material.MajorBase" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MajorBaseToleranceNegative))" value="@material.MajorBaseToleranceNegative" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MajorBaseTolerancePositive))" value="@material.MajorBaseTolerancePositive" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MinorBase))" value="@material.MinorBase" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MinorBaseToleranceNegative))" value="@material.MinorBaseToleranceNegative" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MinorBaseTolerancePositive))" value="@material.MinorBaseTolerancePositive" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Flatness))" value="@material.Flatness" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.FlatnessToleranceNegative))" value="@material.FlatnessToleranceNegative" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.FlatnessTolerancePositive))" value="@material.FlatnessTolerancePositive" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MasterCoilWeight))" value="@material.MasterCoilWeight" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InnerCoilDiameterArrival))" value="@material.InnerCoilDiameterArrival" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.OuterCoilDiameterArrival))" value="@material.OuterCoilDiameterArrival" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InnerCoilDiameterDelivery))" value="@material.InnerCoilDiameterDelivery" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.OuterCoilDiameterDelivery))" value="@material.OuterCoilDiameterDelivery" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.PackagingStandard))" value="@material.PackagingStandard" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.SpecialRequirement))" value="@material.SpecialRequirement" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.SpecialPackaging))" value="@material.SpecialPackaging" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_File_CAD_Drawing))" value="@material.ID_File_CAD_Drawing" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.IsFile))" value="@material.IsFile" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.CADFileName))" value="@(material.CTZ_Files != null? material.CTZ_Files.Name : string.Empty)" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.TurnOver))" value="@(material.TurnOver.HasValue && material.TurnOver.Value == true ? "true" :"false")" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.TurnOverSide))" value="@material.TurnOverSide" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_File_Packaging))" value="@material.ID_File_Packaging" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.IsPackagingFile))" value="@material.IsPackagingFile" />
                                                    <input type="hidden" name="materials[@i].PackagingFileName" value="@(material.CTZ_Files1?.Name ?? string.Empty)" />
                                                    <input type="hidden" name="materials[@i].StrapTypeObservations" value="@material.StrapTypeObservations" />
                                                    <input type="hidden" name="materials[@i].AdditionalsOtherDescription" value="@material.AdditionalsOtherDescription" />
                                                    <input type="hidden" name="materials[@i].LabelOtherDescription" value="@material.LabelOtherDescription" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_File_TechnicalSheet))" value="@material.ID_File_TechnicalSheet" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.IsTechnicalSheetFile))" value="@material.IsTechnicalSheetFile" />
                                                    <input type="hidden" name="materials[@i].TechnicalSheetFileName" value="@(material.CTZ_Files2?.Name ?? string.Empty)" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_File_Additional))" value="@material.ID_File_Additional" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.IsAdditionalFile))" value="@material.IsAdditionalFile" />
                                                    <input type="hidden" name="materials[@i].AdditionalFileName" value="@(material.CTZ_Files3?.Name ?? string.Empty)" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_File_ArrivalAdditional))" value="@material.ID_File_ArrivalAdditional" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.IsArrivalAdditionalFile))" value="@material.IsArrivalAdditionalFile" />
                                                    <input type="hidden" name="materials[@i].ArrivalAdditionalFileName" value="@(material.CTZ_Files4?.Name ?? string.Empty)" />
                                                    <input type="hidden" name="materials[@i].ID_File_CoilDataAdditional" value="@material.ID_File_CoilDataAdditional" />
                                                    <input type="hidden" name="materials[@i].IsCoilDataAdditionalFile" value="@material.IsCoilDataAdditionalFile" />
                                                    <input type="hidden" name="materials[@i].CoilDataAdditionalFileName" value="@(material.CTZ_Files5?.Name ?? string.Empty)" />
                                                    <input type="hidden" name="materials[@i].ID_File_SlitterDataAdditional" value="@material.ID_File_SlitterDataAdditional" />
                                                    <input type="hidden" name="materials[@i].IsSlitterDataAdditionalFile" value="@material.IsSlitterDataAdditionalFile" />
                                                    <input type="hidden" name="materials[@i].SlitterDataAdditionalFileName" value="@(material.CTZ_Files6?.Name ?? string.Empty)" />
                                                    <input type="hidden" name="materials[@i].ID_File_VolumeAdditional" value="@material.ID_File_VolumeAdditional" />
                                                    <input type="hidden" name="materials[@i].IsVolumeAdditionalFile" value="@material.IsVolumeAdditionalFile" />
                                                    <input type="hidden" name="materials[@i].VolumeAdditionalFileName" value="@(material.CTZ_Files7?.Name ?? string.Empty)" />
                                                    <input type="hidden" name="materials[@i].ID_File_OutboundFreightAdditional" value="@material.ID_File_OutboundFreightAdditional" />
                                                    <input type="hidden" name="materials[@i].IsOutboundFreightAdditionalFile" value="@material.IsOutboundFreightAdditionalFile" />
                                                    <input type="hidden" name="materials[@i].OutboundFreightAdditionalFileName" value="@(material.CTZ_Files8?.Name ?? string.Empty)" />
                                                    <input type="hidden" name="materials[@i].ID_File_DeliveryPackagingAdditional" value="@material.ID_File_DeliveryPackagingAdditional" />
                                                    <input type="hidden" name="materials[@i].IsDeliveryPackagingAdditionalFile" value="@material.IsDeliveryPackagingAdditionalFile" />
                                                    <input type="hidden" name="materials[@i].DeliveryPackagingAdditionalFileName" value="@(material.CTZ_Files9?.Name ?? string.Empty)" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Width))" value="@material.Shearing_Width" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Width_Tol_Pos))" value="@material.Shearing_Width_Tol_Pos" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Width_Tol_Neg))" value="@material.Shearing_Width_Tol_Neg" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pitch))" value="@material.Shearing_Pitch" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pitch_Tol_Pos))" value="@material.Shearing_Pitch_Tol_Pos" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pitch_Tol_Neg))" value="@material.Shearing_Pitch_Tol_Neg" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Weight))" value="@material.Shearing_Weight" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Weight_Tol_Pos))" value="@material.Shearing_Weight_Tol_Pos" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Weight_Tol_Neg))" value="@material.Shearing_Weight_Tol_Neg" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pieces_Per_Stroke))" value="@material.Shearing_Pieces_Per_Stroke" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pieces_Per_Car))" value="@material.Shearing_Pieces_Per_Car" />
                                                    <!--Nuevos campos de -->
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_InterplantDelivery_Coil_Position))" value="@material.ID_InterplantDelivery_Coil_Position" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_InterplantDelivery_Transport_Type))" value="@material.ID_InterplantDelivery_Transport_Type" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantDelivery_Transport_Type_Other))" value="@material.InterplantDelivery_Transport_Type_Other" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantPackagingStandard))" value="@material.InterplantPackagingStandard" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantRequiresRackManufacturing))" value="@(material.InterplantRequiresRackManufacturing.HasValue && material.InterplantRequiresRackManufacturing.Value ? "true" : "false")" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantRequiresDieManufacturing))" value="@(material.InterplantRequiresDieManufacturing.HasValue && material.InterplantRequiresDieManufacturing.Value ? "true" : "false")" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantPiecesPerPackage))" value="@material.InterplantPiecesPerPackage" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantStacksPerPackage))" value="@material.InterplantStacksPerPackage" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantPackageWeight))" value="@material.InterplantPackageWeight" />

                                                    @if (material.SelectedRackTypeIds != null)
                                                    {
                                                        foreach (var id in material.SelectedRackTypeIds)
                                                        {<input type="hidden" name="materials[@i].SelectedRackTypeIds" value="@id" />}
                                                    }
                                                    @if (material.SelectedAdditionalIds != null)
                                                    {
                                                        foreach (var id in material.SelectedAdditionalIds)
                                                        {<input type="hidden" name="materials[@i].SelectedAdditionalIds" value="@id" />}
                                                    }
                                                    @if (material.SelectedLabelIds != null)
                                                    {
                                                        foreach (var id in material.SelectedLabelIds)
                                                        {<input type="hidden" name="materials[@i].SelectedLabelIds" value="@id" />}
                                                    }
                                                    @if (material.SelectedStrapTypeIds != null)
                                                    {
                                                        foreach (var id in material.SelectedStrapTypeIds)
                                                        {<input type="hidden" name="materials[@i].SelectedStrapTypeIds" value="@id" />}
                                                    }
                                                    <!-- Nuevos anchos -->
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Mults))" value="@material.Width_Mults" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Mults_Tol_Neg))" value="@material.Width_Mults_Tol_Neg" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Mults_Tol_Pos))" value="@material.Width_Mults_Tol_Pos" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Plates))" value="@material.Width_Plates" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Plates_Tol_Neg))" value="@material.Width_Plates_Tol_Neg" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Plates_Tol_Pos))" value="@material.Width_Plates_Tol_Pos" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Coil_Position))" value="@material.ID_Coil_Position" />
                                                    <input type="hidden" name="materials[@i].ID_Arrival_Transport_Type" value="@material.ID_Arrival_Transport_Type" />
                                                    <input type="hidden" name="materials[@i].ID_Arrival_Packaging_Type" value="@material.ID_Arrival_Packaging_Type" />
                                                    <input type="hidden" name="materials[@i].ID_Arrival_Protective_Material" value="@material.ID_Arrival_Protective_Material" />
                                                    <input type="hidden" name="materials[@i].Arrival_Protective_Material_Other" value="@material.Arrival_Protective_Material_Other" />
                                                    <input type="hidden" name="materials[@i].Is_By_Container" value="@(material.Is_By_Container.HasValue && material.Is_By_Container.Value ? "true" : "false")" />
                                                    <input type="hidden" name="materials[@i].Is_Stackable" value="@(material.Is_Stackable.HasValue && material.Is_Stackable.Value ? "true" : "false")" />
                                                    <input type="hidden" name="materials[@i].Stackable_Levels" value="@material.Stackable_Levels" />
                                                    <input type="hidden" name="materials[@i].Arrival_Comments" value="@material.Arrival_Comments" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Arrival_Transport_Type_Other))" value="@material.Arrival_Transport_Type_Other" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.AnnualTonnage))" value="@material.AnnualTonnage" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.PiecesPerPackage))" value="@material.PiecesPerPackage" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.StacksPerPackage))" value="@material.StacksPerPackage" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.PackageWeight))" value="@material.PackageWeight" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.DeliveryConditions))" value="@material.DeliveryConditions" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.IsReturnableRack))" value="@(material.IsReturnableRack.HasValue && material.IsReturnableRack.Value ? "true" : "false")" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ReturnableUses))" value="@material.ReturnableUses" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Delivery_Coil_Position))" value="@material.ID_Delivery_Coil_Position" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Delivery_Transport_Type))" value="@material.ID_Delivery_Transport_Type" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Delivery_Transport_Type_Other))" value="@material.Delivery_Transport_Type_Other" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_FreightType))" value="@material.ID_FreightType" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Arrival_Warehouse))" value="@material.ID_Arrival_Warehouse" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ClientNetWeight))" value="@material.ClientNetWeight" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.IsRunningChange))" value="@(material.IsRunningChange.HasValue && material.IsRunningChange.Value ? "true" : "false")" />
                                                    <input type="hidden" name="materials[@i].IsWeldedBlank" value="@(material.IsWeldedBlank.HasValue && material.IsWeldedBlank.Value ? "true" : "false")" />
                                                    <input type="hidden" name="materials[@i].NumberOfPlates" value="@material.NumberOfPlates" />
                                                    <input type="hidden" name="materials[@i].WeldedPlatesJson" value="@material.WeldedPlatesJson" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ScrapReconciliation))" value="@(material.ScrapReconciliation.HasValue && material.ScrapReconciliation.Value ? "true" : "false")" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ScrapReconciliationPercent))" value="@material.ScrapReconciliationPercent" />
                                                    <input type="hidden" name="materials[@i].ScrapReconciliationPercent_Min" value="@material.ScrapReconciliationPercent_Min" />
                                                    <input type="hidden" name="materials[@i].ScrapReconciliationPercent_Max" value="@material.ScrapReconciliationPercent_Max" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.HeadTailReconciliation))" value="@(material.HeadTailReconciliation.HasValue && material.HeadTailReconciliation.Value ? "true" : "false")" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.HeadTailReconciliationPercent))" value="@material.HeadTailReconciliationPercent" />
                                                    <input type="hidden" name="materials[@i].HeadTailReconciliationPercent_Min" value="@material.HeadTailReconciliationPercent_Min" />
                                                    <input type="hidden" name="materials[@i].HeadTailReconciliationPercent_Max" value="@material.HeadTailReconciliationPercent_Max" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.WeightOfFinalMults))" value="@material.WeightOfFinalMults" />
                                                    <input type="hidden" name="materials[@i].WeightOfFinalMults_Min" value="@material.WeightOfFinalMults_Min" />
                                                    <input type="hidden" name="materials[@i].WeightOfFinalMults_Max" value="@material.WeightOfFinalMults_Max" />
                                                    <input type="hidden" name="materials[@i].PassesThroughSouthWarehouse" value="@(material.PassesThroughSouthWarehouse.HasValue && material.PassesThroughSouthWarehouse.Value ? "true" : "false")" />
                                                    <input type="hidden" name="materials[@i].ClientScrapReconciliationPercent" value="@material.ClientScrapReconciliationPercent" />
                                                    <input type="hidden" name="materials[@i].ClientHeadTailReconciliationPercent" value="@material.ClientHeadTailReconciliationPercent" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.IsCarryOver))" value="@(material.IsCarryOver.HasValue && material.IsCarryOver.Value ? "true" : "false")" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.RequiresRackManufacturing))" value="@(material.RequiresRackManufacturing.HasValue && material.RequiresRackManufacturing.Value ? "true" : "false")" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.RequiresDieManufacturing))" value="@(material.RequiresDieManufacturing.HasValue && material.RequiresDieManufacturing.Value ? "true" : "false")" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Interplant_Plant))" value="@material.ID_Interplant_Plant" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InitialWeightPerPart))" value="@material.InitialWeightPerPart" />
                                                    <input type="hidden" name="materials[@i].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ShippingTons))" value="@material.ShippingTons" />
                                                    @if (material.SelectedInterplantRackTypeIds != null)
                                                    {
                                                        foreach (var id in material.SelectedInterplantRackTypeIds)
                                                        {
                                                            <input type="hidden" name="materials[@i].SelectedInterplantRackTypeIds" value="@id" />
                                                        }
                                                    }
                                                </td>
                                                <td nowrap>@Html.DisplayFor(model => material.Vehicle)</td>
                                                <td nowrap>@material.Vehicle_version</td>
                                                <td nowrap>@(material.SOP_SP.HasValue? material.SOP_SP.Value.ToString("yyyy-MM"):"")</td>
                                                <td nowrap>@(material.EOP_SP.HasValue? material.EOP_SP.Value.ToString("yyyy-MM"):"")</td>
                                                <td nowrap>@(material.Real_SOP.HasValue? material.Real_SOP.Value.ToString("yyyy-MM"):"")</td>
                                                <td nowrap>@(material.Real_EOP.HasValue? material.Real_EOP.Value.ToString("yyyy-MM"):"")</td>
                                                <td nowrap>@material.Ship_To</td>
                                                <td nowrap>@material.Part_Name</td>
                                                <td nowrap>@material.Part_Number</td>
                                                <td nowrap>@material.Quality</td>
                                                <td nowrap>@material.Program_SP</td>
                                                <td nowrap>@material.Max_Production_SP</td>
                                                <td nowrap>@material.Annual_Volume</td>
                                                <td nowrap>@material.Volume_Per_year</td>
                                                <td nowrap>@(material.CTZ_Route != null ? material.CTZ_Route.Route_Name : "")</td>
                                                <td nowrap>@material.Tensile_Strenght</td>
                                                <td nowrap>@(material.CTZ_Material_Type != null ? material.CTZ_Material_Type.Material_Name : "")</td>
                                                <td nowrap>@material.Thickness</td>
                                                <td nowrap>@material.Width</td>
                                                <td nowrap>@material.Pitch</td>
                                                <td nowrap>@material.Blanks_Per_Stroke</td>
                                                <td nowrap>@material.Parts_Per_Vehicle</td>
                                                <td nowrap>@material.Theoretical_Gross_Weight</td>
                                                <td nowrap>@material.Gross_Weight</td>
                                                <td nowrap>@(material.SCDM_cat_forma_material != null ? material.SCDM_cat_forma_material.ConcatKey : "")</td>
                                                <td nowrap>@material.Angle_A</td>
                                                <td nowrap>@material.Angle_B</td>
                                                <td nowrap>@(material.CTZ_Production_Lines != null ? material.CTZ_Production_Lines.Description : "")</td>
                                                <td nowrap>@(material.CTZ_Production_Lines1 != null ? material.CTZ_Production_Lines1.Description : "")</td>
                                                <td nowrap>@material.Theoretical_Strokes</td>
                                                <td nowrap>@material.Real_Strokes</td>
                                                <td nowrap>@material.Ideal_Cycle_Time_Per_Tool</td>
                                                <td nowrap>@material.OEE</td>
                                                <td nowrap class="dm-status-cell" data-material-id="@material.ID_Material"> @material.DM_status</td>
                                                <td nowrap class="dm-status-comment-cell" data-material-id="@material.ID_Material"> @material.DM_status_comment</td>
                                            </tr>
                                        }
                                    }
                                </tbody>
                            </table>

                            <br />

                            <!-- SECCIÓN DE INPUTS: material-form -->
                            <div class="material-form">
                                <!-- TITLE FOR THE MATERIAL FORM -->
                                <div class="material-form-title">Part Number Information</div>

                                <input type="hidden" id="materialIndex" value="" />
                                <input type="hidden" id="materialId" value="" />
                                <input type="hidden" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_File_CAD_Drawing))" value="" />
                                <input type="hidden" id="CADFileName" value="" />
                                <input type="hidden" id="ID_File_Packaging" value="" />
                                <input type="hidden" id="PackagingFileName" value="" />
                                <input type="hidden" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_File_TechnicalSheet))" value="" />
                                <input type="hidden" id="TechnicalSheetFileName" value="" />
                                <input type="hidden" id="ID_File_Additional" value="" />
                                <input type="hidden" id="AdditionalFileName" value="" />
                                <input type="hidden" id="ID_File_ArrivalAdditional" value="" />
                                <input type="hidden" id="ArrivalAdditionalFileName" value="" />
                                <input type="hidden" id="ID_File_CoilDataAdditional" value="" />
                                <input type="hidden" id="CoilDataAdditionalFileName" value="" />
                                <input type="hidden" id="ID_File_SlitterDataAdditional" value="" />
                                <input type="hidden" id="SlitterDataAdditionalFileName" value="" />
                                <input type="hidden" id="ID_File_VolumeAdditional" value="" />
                                <input type="hidden" id="VolumeAdditionalFileName" value="" />
                                <input type="hidden" id="ID_File_OutboundFreightAdditional" value="" />
                                <input type="hidden" id="OutboundFreightAdditionalFileName" value="" />
                                <input type="hidden" id="ID_File_DeliveryPackagingAdditional" value="" />
                                <input type="hidden" id="DeliveryPackagingAdditionalFileName" value="" />
                                <input type="hidden" id="weldedPlatesJson" value="" />

                                <!-- VEHICLE INFORMATION -->
                                <fieldset class="mb-3" disabled="@isDetailsMode">
                                    <legend>Vehicle Information</legend>
                                    <div class="row">
                                        @if (Model.ID_VehicleType.HasValue && Model.ID_VehicleType.Value == 1)
                                        {
                                            <div class="col-md-4">
                                                <label for="ihsCountry1">S&P Country</label>
                                                @if (canEditSales)
                                                {
                                                    @Html.DropDownList("ihsCountry1", (IEnumerable<SelectListItem>)ViewBag.IHSCountries, new { @class = "form-control select2 ihs-country-selector", data_target_vehicle = "#Vehicle" })
                                                }
                                                else
                                                {
                                                    @Html.DropDownList("ihsCountry1", (IEnumerable<SelectListItem>)ViewBag.IHSCountries, new { @class = "form-control select2 ihs-country-selector", data_target_vehicle = "#Vehicle", @disabled = "disabled" })
                                                }
                                            </div>
                                            <div class="col-md-6">
                                                <label>
                                                    Vehicle
                                                    <i class="fa fa-question-circle" data-toggle="tooltip" data-placement="right" title="Select a vehicle from the list."></i>
                                                </label>
                                                <select id="Vehicle" class="form-control select2" @(!canEditSales ? "disabled" : string.Empty)>
                                                    <option value="">Select a Vehicle</option>
                                                    @foreach (var item in (IEnumerable<Portal_2_0.Controllers.VehicleItem>)ViewBag.VehicleList)
                                                    {
                                                        <option value="@item.Value" data-sop="@item.SOP" data-eop="@item.EOP"
                                                                data-program="@item.Program" data-maxproduction="@item.MaxProduction"
                                                                data-productionjson='@item.ProductionDataJson'>
                                                            @item.Text
                                                        </option>
                                                    }
                                                </select>
                                                <span id="VehicleError" class="error-message" style="color: red; display: none;"></span>
                                            </div>
                                            <div class="col-md-4 vehicle-row-2">
                                                <label for="ihsCountry2">S&P Country</label>
                                                @if (canEditSales)
                                                {
                                                    @Html.DropDownList("ihsCountry2", (IEnumerable<SelectListItem>)ViewBag.IHSCountries, new { @class = "form-control select2 ihs-country-selector", data_target_vehicle = "#Vehicle_2" })
                                                }
                                                else
                                                {
                                                    @Html.DropDownList("ihsCountry2", (IEnumerable<SelectListItem>)ViewBag.IHSCountries, new { @class = "form-control select2 ihs-country-selector", data_target_vehicle = "#Vehicle_2", @disabled = "disabled" })
                                                }
                                            </div>
                                            <div class="col-md-6 vehicle-row-2">
                                                <label>Vehicle 2</label>
                                                <select id="Vehicle_2" class="form-control select2" @(!canEditSales ? "disabled" : string.Empty)>
                                                    <option value="">Select a Vehicle</option>
                                                    @foreach (var item in (IEnumerable<Portal_2_0.Controllers.VehicleItem>)ViewBag.VehicleList)
                                                    {
                                                        <option value="@item.Value" data-sop="@item.SOP" data-eop="@item.EOP"
                                                                data-program="@item.Program" data-maxproduction="@item.MaxProduction"
                                                                data-productionjson='@item.ProductionDataJson'>
                                                            @item.Text
                                                        </option>
                                                    }
                                                </select>
                                            </div>

                                            <div class="col-md-4 vehicle-row-3">
                                                <label for="ihsCountry3">S&P Country</label>
                                                @if (canEditSales)
                                                {
                                                    @Html.DropDownList("ihsCountry3", (IEnumerable<SelectListItem>)ViewBag.IHSCountries, new { @class = "form-control select2 ihs-country-selector", data_target_vehicle = "#Vehicle_3" })
                                                }
                                                else
                                                {
                                                    @Html.DropDownList("ihsCountry3", (IEnumerable<SelectListItem>)ViewBag.IHSCountries, new { @class = "form-control select2 ihs-country-selector", data_target_vehicle = "#Vehicle_3", @disabled = "disabled" })
                                                }
                                            </div>
                                            <div class="col-md-6 vehicle-row-3">
                                                <label>Vehicle 3</label>
                                                <select id="Vehicle_3" class="form-control select2" @(!canEditSales ? "disabled" : string.Empty)>
                                                    <option value="">Select a Vehicle</option>
                                                    @foreach (var item in (IEnumerable<Portal_2_0.Controllers.VehicleItem>)ViewBag.VehicleList)
                                                    {
                                                        <option value="@item.Value" data-sop="@item.SOP" data-eop="@item.EOP"
                                                                data-program="@item.Program" data-maxproduction="@item.MaxProduction"
                                                                data-productionjson='@item.ProductionDataJson'>
                                                            @item.Text
                                                        </option>
                                                    }
                                                </select>
                                            </div>

                                            <div class="col-md-6" style="display:none">
                                                <label>Vehicle 4</label>
                                                <select id="Vehicle_4" class="form-control select2" @(!canEditSales ? "disabled" : string.Empty)>
                                                    <option value="">Select a Vehicle</option>
                                                    @foreach (var item in (IEnumerable<Portal_2_0.Controllers.VehicleItem>)ViewBag.VehicleList)
                                                    {
                                                        <option value="@item.Value" data-sop="@item.SOP" data-eop="@item.EOP"
                                                                data-program="@item.Program" data-maxproduction="@item.MaxProduction"
                                                                data-productionjson='@item.ProductionDataJson'>
                                                            @item.Text
                                                        </option>
                                                    }
                                                </select>
                                            </div>
                                        }
                                        else
                                        {
                                            // El caso para vehículos no automotrices no cambia
                                            <div class="col-md-8">
                                                <label>
                                                    Vehicle
                                                    <i class="fa fa-question-circle" data-toggle="tooltip" data-placement="right" title="Enter the vehicle name."></i>
                                                </label>
                                                <input type="text" id="Vehicle" name="Vehicle" class="form-control" placeholder="Enter Vehicle" maxlength="120" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                                <span id="VehicleError" class="error-message" style="color: red; display: none;"></span>
                                            </div>
                                        }

                                    </div>
                                    <div class="row">
                                        <div class="col-md-4">
                                            <label>Vehicle Version</label>
                                            <input type="text" id="vehicleVersion" class="form-control" placeholder="Vehicle Version" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="vehicleVersionError" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div class="col-md-2">
                                            <label>Program SP</label>
                                            <input type="text" id="programSP" class="form-control" placeholder="Program SP" readonly />
                                        </div>
                                        <div class="col-md-3 d-flex align-items-center">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="isRunningChange" @(!canEditSales ? "disabled" : "")>
                                                <label class="form-check-label" for="isRunningChange">
                                                    Is Running Change?
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-3 d-flex align-items-center" id="IsCarryOver_container">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="IsCarryOver" @(!canEditSales ? "disabled" : "")>
                                                <label class="form-check-label" for="IsCarryOver">
                                                    Is Carry Over?
                                                </label>
                                                <span id="IsCarryOverError" class="error-message" style="color: red; display: none;"></span>
                                            </div>
                                        </div>
                                    </div>
                                </fieldset>

                                <!-- PRODUCTION & SHIPPING DATES -->
                                <fieldset class="mb-3">
                                    <legend>Production & Route</legend>
                                    <div class="row">
                                        <div class="col-md-1">
                                            <label>
                                                @Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().SOP_SP)
                                                <i class="fa fa-question-circle"
                                                   data-toggle="tooltip"
                                                   data-placement="right"
                                                   data-html="true"
                                                   title="Planned Start Of Production (yyyy-MM)."></i>
                                            </label>
                                            <input type="text" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.SOP_SP))" class="form-control" placeholder="yyyy-MM" readonly />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.SOP_SP))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div class="col-md-1">
                                            <label>
                                                @Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().EOP_SP)
                                                <i class="fa fa-question-circle"
                                                   data-toggle="tooltip"
                                                   data-placement="right"
                                                   data-html="true"
                                                   title="Planned End Of Production (yyyy-MM)."></i>
                                            </label>
                                            <input type="text" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.EOP_SP))" class="form-control" placeholder="yyyy-MM" readonly />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.EOP_SP))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div class="col-md-1">
                                            <label>
                                                @Html.DisplayNameFor(m => m.CTZ_Project_Materials.First().Real_SOP)
                                                <i class="fa fa-question-circle"
                                                   data-toggle="tooltip"
                                                   data-placement="right"
                                                   data-html="true"
                                                   title="Actual Start Of Production (yyyy-MM)."></i>
                                            </label>
                                            <input type="text"
                                                   id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Real_SOP))"
                                                   name="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Real_SOP))"
                                                   class="form-control"
                                                   placeholder="yyyy‑MM"
                                                   @(canEditSales ? "" : "readonly") autocomplete="off" />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Real_SOP))Error"
                                                  class="error-message"
                                                  style="color: red; display: none;"></span>
                                        </div>

                                        <div class="col-md-1">
                                            <label>
                                                @Html.DisplayNameFor(m => m.CTZ_Project_Materials.First().Real_EOP)
                                                <i class="fa fa-question-circle"
                                                   data-toggle="tooltip"
                                                   data-placement="right"
                                                   data-html="true"
                                                   title="Actual End Of Production (yyyy-MM)."></i>
                                            </label>
                                            <input type="text"
                                                   id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Real_EOP))"
                                                   name="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Real_EOP))"
                                                   class="form-control"
                                                   placeholder="yyyy‑MM"
                                                   @(canEditSales ? "" : "readonly") autocomplete="off" />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Real_EOP))Error"
                                                  class="error-message"
                                                  style="color: red; display: none;"></span>
                                        </div>
                                        <div class="col-md-4">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Ship_To)</label>
                                            <input type="text" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Ship_To))" class="form-control" placeholder="Ship To" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Ship_To))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>

                                        <div class="col-md-4">
                                            <label>Part Name</label>
                                            <input type="text" id="partName" class="form-control" placeholder="Part Name" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="partNameError" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div class="col-md-4">
                                            <label>Part Number</label>
                                            <input type="text" id="partNumber" class="form-control" placeholder="Part Number" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="partNumberError" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Max_Production_SP)</label>
                                            <input type="text" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Max_Production_SP))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Max_Production_SP)" readonly />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Max_Production_SP))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_Route)</label>
                                            @if (canEditSales) //enabled
                                            {
                                                @Html.DropDownList("ID_Route", new SelectList(ViewBag.ID_RouteList, "Value", "Text"), "Select a Route", new { @class = "form-control select2", id = "ID_Route" })
                                            }
                                            else //disabled
                                            {
                                                @Html.DropDownList("ID_Route", new SelectList(ViewBag.ID_RouteList, "Value", "Text"), "Select a Route", new { @class = "form-control select2", id = "ID_Route", disabled = "disabled" })
                                            }
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Route))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Interplant_Plant))_container" class="col-md-2" style="display: none;">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_Interplant_Plant)</label>
                                            @if (canEditSales)
                                            {
                                                @Html.DropDownListFor(model => model.CTZ_Project_Materials.First().ID_Interplant_Plant, (SelectList)ViewBag.InterplantPlantList, "-- Select Facility --", new { @class = "form-control select2" })
                                            }
                                            else
                                            {
                                                @Html.DropDownListFor(model => model.CTZ_Project_Materials.First().ID_Interplant_Plant, (SelectList)ViewBag.InterplantPlantList, "-- Select Facility --", new { @class = "form-control select2", disabled = "disabled" })
                                            }
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Interplant_Plant))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                    </div>
                                </fieldset>

                                <!-- ARRIVAL PACKAGING -->
                                <fieldset class="mb-3">
                                    <legend>Arrival Packaging</legend>

                                    <div class="row">
                                        <div class="col-md-3" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Coil_Position))_container">
                                            <label>
                                                Coil Position
                                            </label>
                                            @if (canEditSales)
                                            {
                                                @Html.DropDownList("ID_Coil_Position", (SelectList)ViewBag.CoilPositionList, "Select an option", new { @class = "form-control select2" })
                                            }
                                            else
                                            {
                                                @Html.DropDownList("ID_Coil_Position", (SelectList)ViewBag.CoilPositionList, "Select an option", new { @class = "form-control select2", disabled = "disabled" })
                                            }
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Coil_Position))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div class="col-md-3" id="ID_Arrival_Transport_Type_container">
                                            <label for="ID_Arrival_Transport_Type">Transport Type</label>
                                            @if (canEditSales)
                                            {
                                                @Html.DropDownList("ID_Arrival_Transport_Type", (SelectList)ViewBag.ArrivalTransportTypeList, "Select an option", new { @class = "form-control select2" })
                                            }
                                            else
                                            {
                                                @Html.DropDownList("ID_Arrival_Transport_Type", (SelectList)ViewBag.ArrivalTransportTypeList, "Select an option", new { @class = "form-control select2", disabled = "disabled" })
                                            }
                                            <span id="ID_Arrival_Transport_TypeError" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div class="col-md-3" id="Arrival_Transport_Type_Other_container" style="display: none;">
                                            <label for="Arrival_Transport_Type_Other">Specify "Other" Transport</label>
                                            <input type="text" id="Arrival_Transport_Type_Other" class="form-control"
                                                   placeholder="Specify transport..." maxlength="50"
                                                   @(canEditSales ? "" : "readonly") autocomplete="off" />
                                            <span id="Arrival_Transport_Type_OtherError" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div class="col-md-3" id="ID_Arrival_Packaging_Type_container">
                                            <label for="ID_Arrival_Packaging_Type">Packaging Type</label>
                                            @if (canEditSales) // O el permiso que corresponda
                                            {
                                                @Html.DropDownList("ID_Arrival_Packaging_Type", (SelectList)ViewBag.ArrivalRackTypeList, "Select an option", new { @class = "form-control select2" })
                                            }
                                            else
                                            {
                                                @Html.DropDownList("ID_Arrival_Packaging_Type", (SelectList)ViewBag.ArrivalRackTypeList, "Select an option", new { @class = "form-control select2", disabled = "disabled" })
                                            }
                                            <span id="ID_Arrival_Packaging_TypeError" class="error-message" style="color: red; display: none;"></span>
                                        </div>

                                        <div class="col-md-3" id="ID_Arrival_Protective_Material_container">
                                            <label for="ID_Arrival_Protective_Material">Protective Material</label>
                                            @if (canEditSales) // O el permiso que corresponda
                                            {
                                                @Html.DropDownList("ID_Arrival_Protective_Material", (SelectList)ViewBag.ArrivalAdditionalList, "Select an option", new { @class = "form-control select2" })
                                            }
                                            else
                                            {
                                                @Html.DropDownList("ID_Arrival_Protective_Material", (SelectList)ViewBag.ArrivalAdditionalList, "Select an option", new { @class = "form-control select2", disabled = "disabled" })
                                            }
                                            <span id="ID_Arrival_Protective_MaterialError" class="error-message" style="color: red; display: none;"></span>
                                        </div>

                                        <div class="col-md-3" id="Arrival_Protective_Material_Other_container" style="display: none;">
                                            <label for="Arrival_Protective_Material_Other">Specify "Other" Material</label>
                                            <input type="text" id="Arrival_Protective_Material_Other" class="form-control"
                                                   placeholder="Specify material..." maxlength="120"
                                                   @(canEditSales ? "" : "readonly") autocomplete="off" />
                                            <span id="Arrival_Protective_Material_OtherError" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                    </div>

                                    <div class="row" style="margin-top: 15px;">
                                        <div class="col-md-3" id="Is_By_Container_container">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="Is_By_Container" @(canEditSales ? "" : "disabled")>
                                                <label class="form-check-label" for="Is_By_Container">
                                                    By Container?
                                                </label>
                                            </div>
                                        </div>

                                        <div class="col-md-3" id="Is_Stackable_container">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="Is_Stackable" @(canEditSales ? "" : "disabled")>
                                                <label class="form-check-label" for="Is_Stackable">
                                                    Is it stackable?
                                                </label>
                                            </div>
                                        </div>

                                        <div class="col-md-3" id="Stackable_Levels_container" style="display: none;">
                                            <label for="Stackable_Levels">Stackable Levels</label>
                                            <input type="number" id="Stackable_Levels" class="form-control" placeholder="Levels" min="0" @(canEditSales ? "" : "readonly") />
                                            <span id="Stackable_LevelsError" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                    </div>

                                    <div class="row" style="margin-top: 15px;">
                                        @if ((int)ViewBag.ProjectPlantId == 1)
                                        {  // 1 es el ID de Puebla

                                            <div class="col-md-4" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Arrival_Warehouse))_container">
                                                <label for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Arrival_Warehouse))">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_Arrival_Warehouse)</label>
                                                @if (canEditSales)
                                                {
                                                    @Html.DropDownList(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Arrival_Warehouse), (SelectList)ViewBag.WarehouseList, "Select an option", new { @class = "form-control select2" })
                                                }
                                                else
                                                {
                                                    @Html.DropDownList(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Arrival_Warehouse), (SelectList)ViewBag.WarehouseList, "Select an option", new { @class = "form-control select2", disabled = "disabled" })
                                                }
                                                <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Arrival_Warehouse))Error" class="error-message" style="color: red; display: none;"></span>
                                            </div>
                                            <div id="PassesThroughSouthWarehouse_container" class="col-md-3 d-flex align-items-center">
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="PassesThroughSouthWarehouse" @(canEditSales ? "" : "disabled")>
                                                    <label class="form-check-label" for="PassesThroughSouthWarehouse">
                                                        @Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().PassesThroughSouthWarehouse)
                                                    </label>
                                                </div>
                                                <span id="PassesThroughSouthWarehouseError" class="error-message" style="color: red; display: none;"></span>
                                            </div>
                                        }
                                        <div id="file_container_arrivalAdditionalFile" class="col-md-4">
                                            <label for="arrivalAdditionalFile">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_File_ArrivalAdditional)</label>
                                            <div class="col-md-12">
                                                <input type="file" id="arrivalAdditionalFile" name="arrivalAdditionalFile" accept=".dwg,.dxf,.dwt,.pdf,.rar,.zip" @(!canEditSales ? "disabled" : string.Empty)>
                                                <button type="button" class="btn btn-danger btn-sm" id="arrivalAdditionalFileCancelButton" style="display: none;" @(!canEditSales ? "disabled" : string.Empty)>Cancel</button>
                                            </div>
                                            <span id="arrivalAdditionalFileError" class="error-message col-md-12" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="fileActions_containerArrivalAdditionalFile" class="col-md-4" style="display: none;">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_File_ArrivalAdditional)</label>
                                            <div class="col-md-12">
                                                <a id="downloadArrivalAdditionalFile" href="#" class="truncate-filename">Download File</a>
                                                <button type="button" class="btn btn-success btn-sm" id="changeFileArrivalAdditionalFile" @(!canEditSales ? "disabled" : string.Empty)>Change</button>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row" style="margin-top: 15px;">
                                        <div class="col-md-12" id="Arrival_Comments_container">
                                            <label for="Arrival_Comments">Comments</label>
                                            <textarea id="Arrival_Comments" class="form-control" rows="3" placeholder="Comments..." @(canEditSales ? "" : "readonly")></textarea>
                                            <span id="Arrival_CommentsError" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                    </div>
                                </fieldset>

                                <!-- COIL INFORMATION -->
                                <fieldset class="mb-3">
                                    <legend>Coil Data</legend>
                                    <div class="row">
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Quality))_container" class="col-md-3">
                                            <label>Quality</label>
                                            <select id="quality" name="quality" class="form-control select2-quality" @(!canEditSales ? "disabled" : String.Empty)></select>
                                            <span id="qualityError" class="error-message" style="color: red; display: none;"></span>
                                        </div>

                                        <div class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_Material_type)</label>
                                            @if (canEditSales) //enabled
                                            {
                                                @Html.DropDownList("ID_Material_type", (SelectList)ViewBag.MaterialTypeList, "Select Material Type", new { @class = "form-control select2" })
                                            }
                                            else //disabled
                                            {
                                                @Html.DropDownList("ID_Material_type", (SelectList)ViewBag.MaterialTypeList, "Select Material Type", new { @class = "form-control select2", disabled = "disabled" })
                                            }
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Material_type))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Tensile_Strenght))_container" class="col-md-2">
                                            @Html.LabelFor(model => model.CTZ_Project_Materials.First().Tensile_Strenght)
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Tensile_Strenght))" class="form-control" placeholder="Tensile Strength" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <small id="tensil-limit-display" class="form-text text-muted limit-display"></small>
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Tensile_Strenght))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>

                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Thickness))_container" class="col-md-2">
                                            @Html.LabelFor(model => model.CTZ_Project_Materials.First().Thickness)
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Thickness))" class="form-control" placeholder="Thickness" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <small id="thickness-limit-display" class="form-text text-muted limit-display"></small>
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Thickness))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ThicknessToleranceNegative))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ThicknessToleranceNegative)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ThicknessToleranceNegative))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ThicknessToleranceNegative)" max="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ThicknessToleranceNegative))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ThicknessTolerancePositive))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ThicknessTolerancePositive)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ThicknessTolerancePositive))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ThicknessTolerancePositive)" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ThicknessTolerancePositive))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width))_container" class="col-md-2">
                                            @Html.LabelFor(model => model.CTZ_Project_Materials.First().Width)
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width))" class="form-control" placeholder="Width" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <small id="width-limit-display" class="form-text text-muted limit-display"></small>
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.WidthToleranceNegative))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().WidthToleranceNegative)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.WidthToleranceNegative))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().WidthToleranceNegative)" max="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.WidthToleranceNegative))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.WidthTolerancePositive))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().WidthTolerancePositive)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.WidthTolerancePositive))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().WidthTolerancePositive)" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.WidthTolerancePositive))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>

                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MasterCoilWeight))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().MasterCoilWeight)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MasterCoilWeight))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().MasterCoilWeight)" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MasterCoilWeight))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InnerCoilDiameterArrival))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().InnerCoilDiameterArrival)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InnerCoilDiameterArrival))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().InnerCoilDiameterArrival)" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InnerCoilDiameterArrival))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.OuterCoilDiameterArrival))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().OuterCoilDiameterArrival)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.OuterCoilDiameterArrival))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().OuterCoilDiameterArrival)" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.OuterCoilDiameterArrival))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="file_container_coilDataAdditionalFile" class="col-md-4">
                                            <label for="coilDataAdditionalFile">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_File_CoilDataAdditional)</label>
                                            <div class="col-md-12">
                                                <input type="file" id="coilDataAdditionalFile" name="coilDataAdditionalFile" accept=".dwg,.dxf,.dwt,.pdf,.rar,.zip" @(!canEditSales ? "disabled" : string.Empty)>
                                                <button type="button" class="btn btn-danger btn-sm" id="coilDataAdditionalFileCancelButton" style="display: none;" @(!canEditSales ? "disabled" : string.Empty)>Cancel</button>
                                            </div>
                                            <span id="coilDataAdditionalFileError" class="error-message col-md-12" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="fileActions_containerCoilDataAdditionalFile" class="col-md-4" style="display: none;">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_File_CoilDataAdditional)</label>
                                            <div class="col-md-12">
                                                <a id="downloadCoilDataAdditionalFile" href="#" class="truncate-filename">Download File</a>
                                                <button type="button" class="btn btn-success btn-sm" id="changeFileCoilDataAdditionalFile" @(!canEditSales ? "disabled" : string.Empty)>Change</button>
                                            </div>
                                        </div>
                                    </div>
                                </fieldset>

                                <!-- Slitter Data -->
                                <fieldset class="mb-3">
                                    <legend>Slitter Data</legend>
                                    <div id="slittingRuleError" class="slitting-rule-warning" style="display: none;">
                                        <p class="error-text">
                                            <i class="fa fa-times-circle"></i>
                                            <strong>Rule Not Found:</strong> No valid slitting rule for the current Thickness/Tensile.
                                        </p>
                                        <div class="rules-table-wrapper">
                                            @if (ViewBag.SlittingRules != null && ((List<Portal_2_0.Controllers.SlittingRuleViewModel>)ViewBag.SlittingRules).Any())
                                            {
                                                <table class="table table-bordered table-sm">
                                                    <thead class="thead-light">
                                                        <tr>
                                                            <th>Slitter</th>
                                                            <th>Thickness</th>
                                                            <th>Tensile (TS)</th>
                                                            <th>Width</th>
                                                            <th>Max. Strips</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        @foreach (var rule in (List<Portal_2_0.Controllers.SlittingRuleViewModel>)ViewBag.SlittingRules)
                                                        {
                                                            <tr>
                                                                <td>@rule.LineName</td>
                                                                <td>@rule.ThicknessRange</td>
                                                                <td>@rule.TensileRange</td>
                                                                <td>@rule.WidthRange</td>
                                                                <td>@rule.MaxStrips</td>
                                                            </tr>
                                                        }
                                                    </tbody>
                                                </table>
                                            }
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Multipliers))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Multipliers)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Multipliers))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Multipliers)" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <small id="mults-limit-display" class="form-text text-muted limit-display"></small>
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Multipliers))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Mults))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Width_Mults)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Mults))" class="form-control" placeholder="Mults Width" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Mults))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Mults_Tol_Neg))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Width_Mults_Tol_Neg)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Mults_Tol_Neg))" class="form-control" placeholder="Tol. (-)" max="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Mults_Tol_Neg))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Mults_Tol_Pos))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Width_Mults_Tol_Pos)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Mults_Tol_Pos))" class="form-control" placeholder="Tol. (+)" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Mults_Tol_Pos))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="WeightOfFinalMults_Min_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().WeightOfFinalMults_Min)</label>
                                            <input type="number" step="any" id="WeightOfFinalMults_Min" class="form-control" placeholder="Min" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="WeightOfFinalMults_MinError" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.WeightOfFinalMults))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().WeightOfFinalMults)</label>
                                            <input type="number" step="any" id="WeightOfFinalMults" class="form-control" placeholder="Optimal" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="WeightOfFinalMultsError" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="WeightOfFinalMults_Max_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().WeightOfFinalMults_Max)</label>
                                            <input type="number" step="any" id="WeightOfFinalMults_Max" class="form-control" placeholder="Max" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="WeightOfFinalMults_MaxError" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InnerCoilDiameterDelivery))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().InnerCoilDiameterDelivery)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InnerCoilDiameterDelivery))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().InnerCoilDiameterDelivery)" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InnerCoilDiameterDelivery))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.OuterCoilDiameterDelivery))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().OuterCoilDiameterDelivery)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.OuterCoilDiameterDelivery))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().OuterCoilDiameterDelivery)" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.OuterCoilDiameterDelivery))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="file_container_slitterDataAdditionalFile" class="col-md-4">
                                            <label for="slitterDataAdditionalFile">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_File_SlitterDataAdditional)</label>
                                            <div class="col-md-12">
                                                <input type="file" id="slitterDataAdditionalFile" name="slitterDataAdditionalFile" accept=".dwg,.dxf,.dwt,.pdf,.rar,.zip" @(!canEditSales ? "disabled" : string.Empty)>
                                                <button type="button" class="btn btn-danger btn-sm" id="slitterDataAdditionalFileCancelButton" style="display: none;" @(!canEditSales ? "disabled" : string.Empty)>Cancel</button>
                                            </div>
                                            <span id="slitterDataAdditionalFileError" class="error-message col-md-12" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="fileActions_containerSlitterDataAdditionalFile" class="col-md-4" style="display: none;">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_File_SlitterDataAdditional)</label>
                                            <div class="col-md-12">
                                                <a id="downloadSlitterDataAdditionalFile" href="#" class="truncate-filename">Download File</a>
                                                <button type="button" class="btn btn-success btn-sm" id="changeFileSlitterDataAdditionalFile" @(!canEditSales ? "disabled" : string.Empty)>Change</button>
                                            </div>
                                        </div>
                                    </div>
                                </fieldset>

                                <!-- Shearing -->
                                <fieldset class="mb-3">
                                    <legend>Shearing Data</legend>
                                    <div class="row">
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Width))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Shearing_Width)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Width))" name="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Width))" class="form-control" placeholder="Shearing Width" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Width))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Width_Tol_Pos))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Shearing_Width_Tol_Pos)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Width_Tol_Pos))" name="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Width_Tol_Pos))" class="form-control" placeholder="Tol. Pos" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Width_Tol_Pos))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Width_Tol_Neg))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Shearing_Width_Tol_Neg)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Width_Tol_Neg))" name="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Width_Tol_Neg))" class="form-control" placeholder="Tol. Neg" max="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Width_Tol_Neg))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pitch))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Shearing_Pitch)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pitch))" name="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pitch))" class="form-control" placeholder="Shearing Pitch" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pitch))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pitch_Tol_Pos))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Shearing_Pitch_Tol_Pos)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pitch_Tol_Pos))" name="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pitch_Tol_Pos))" class="form-control" placeholder="Tol. Pos" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pitch_Tol_Pos))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pitch_Tol_Neg))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Shearing_Pitch_Tol_Neg)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pitch_Tol_Neg))" name="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pitch_Tol_Neg))" class="form-control" placeholder="Tol. Neg" max="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pitch_Tol_Neg))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                    </div>
                                    <div class="row mt-2">
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Weight))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Shearing_Weight)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Weight))" name="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Weight))" class="form-control" placeholder="Shearing Weight" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Weight))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Weight_Tol_Pos))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Shearing_Weight_Tol_Pos)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Weight_Tol_Pos))" name="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Weight_Tol_Pos))" class="form-control" placeholder="Tol. Pos" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Weight_Tol_Pos))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Weight_Tol_Neg))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Shearing_Weight_Tol_Neg)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Weight_Tol_Neg))" name="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Weight_Tol_Neg))" class="form-control" placeholder="Tol. Neg" max="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Weight_Tol_Neg))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pieces_Per_Stroke))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Shearing_Pieces_Per_Stroke)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pieces_Per_Stroke))" name="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pieces_Per_Stroke))" class="form-control" placeholder="Pieces / Stroke" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pieces_Per_Stroke))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pieces_Per_Car))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Shearing_Pieces_Per_Car)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pieces_Per_Car))" name="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pieces_Per_Car))" class="form-control" placeholder="Pieces / Car" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pieces_Per_Car))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                    </div>
                                </fieldset>


                                <!-- Blank Data -->
                                <fieldset id="blankDataDiv" class="mb-3">
                                    <legend>Blank Data</legend>
                                    <div class="row">
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Shape))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_Shape)</label>
                                            @if (canEditSales) //enabled
                                            {
                                                @Html.DropDownList("ID_Shape", (SelectList)ViewBag.ShapeList, "Select Shape", new { @class = "form-control select2" })
                                            }
                                            else //disabled
                                            {
                                                @Html.DropDownList("ID_Shape", (SelectList)ViewBag.ShapeList, "Select Shape", new { @class = "form-control select2", disabled = "disabled" })
                                            }
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Shape))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Plates))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Width_Plates)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Plates))" class="form-control" placeholder="Plates Width" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Plates))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Plates_Tol_Neg))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Width_Plates_Tol_Neg)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Plates_Tol_Neg))" class="form-control" placeholder="Tol. (-)" max="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Plates_Tol_Neg))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Plates_Tol_Pos))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Width_Plates_Tol_Pos)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Plates_Tol_Pos))" class="form-control" placeholder="Tol. (+)" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Plates_Tol_Pos))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Pitch))_container" class="col-md-2">
                                            @Html.LabelFor(model => model.CTZ_Project_Materials.First().Pitch)
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Pitch))" class="form-control" placeholder="Pitch" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <small id="pitch-limit-display" class="form-text text-muted limit-display"></small>
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Pitch))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.PitchToleranceNegative))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().PitchToleranceNegative)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.PitchToleranceNegative))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().PitchToleranceNegative)" max="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.PitchToleranceNegative))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.PitchTolerancePositive))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().PitchTolerancePositive)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.PitchTolerancePositive))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().PitchTolerancePositive)" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.PitchTolerancePositive))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>

                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Flatness))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Flatness)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Flatness))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Flatness)" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Flatness))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.FlatnessToleranceNegative))_container" class="col-md-2">
                                            <label>
                                                @Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().FlatnessToleranceNegative)
                                            </label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.FlatnessToleranceNegative))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().FlatnessToleranceNegative)" max="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.FlatnessToleranceNegative))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>

                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.FlatnessTolerancePositive))_container" class="col-md-2">
                                            <label>
                                                @Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().FlatnessTolerancePositive)
                                            </label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.FlatnessTolerancePositive))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().FlatnessTolerancePositive)" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.FlatnessTolerancePositive))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>

                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Blanks_Per_Stroke))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Blanks_Per_Stroke)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Blanks_Per_Stroke))" class="form-control" placeholder="Blanks Per Stroke" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Blanks_Per_Stroke))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Parts_Per_Vehicle))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Parts_Per_Vehicle)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Parts_Per_Vehicle))" class="form-control" placeholder="Parts Per Vehicle" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Parts_Per_Vehicle))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Theoretical_Gross_Weight))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Theoretical_Gross_Weight)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Theoretical_Gross_Weight))" class="form-control" placeholder="Theoretical Gross Weight" min="0" readonly />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Theoretical_Gross_Weight))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Gross_Weight))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Gross_Weight)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Gross_Weight))" class="form-control" placeholder="Gross Weight" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Gross_Weight))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ClientNetWeight))_container" class="col-md-2">
                                            <label for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ClientNetWeight))">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ClientNetWeight)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ClientNetWeight))" class="form-control" placeholder="Client Net Weight" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ClientNetWeight))Error" class="error-message" style="color: red; display: none;"></span>
                                            <span id="runningChangeWarning" class="field-warning-text">For a Running Change, this value should be entered.</span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Angle_A))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Angle_A)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Angle_A))" class="form-control" placeholder="Angle A" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Angle_A))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.AngleAToleranceNegative))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().AngleAToleranceNegative)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.AngleAToleranceNegative))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().AngleAToleranceNegative)" max="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.AngleAToleranceNegative))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.AngleATolerancePositive))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().AngleATolerancePositive)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.AngleATolerancePositive))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().AngleATolerancePositive)" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.AngleATolerancePositive))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Angle_B))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Angle_B)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Angle_B))" class="form-control" placeholder="Angle B" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Angle_B))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.AngleBToleranceNegative))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().AngleBToleranceNegative)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.AngleBToleranceNegative))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().AngleBToleranceNegative)" max="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.AngleBToleranceNegative))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.AngleBTolerancePositive))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().AngleBTolerancePositive)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.AngleBTolerancePositive))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().AngleBTolerancePositive)" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.AngleBTolerancePositive))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MajorBase))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().MajorBase)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MajorBase))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().MajorBase)" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MajorBase))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MajorBaseToleranceNegative))_container" class="col-md-2">
                                            <label>
                                                @Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().MajorBaseToleranceNegative)
                                            </label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MajorBaseToleranceNegative))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().MajorBaseToleranceNegative)" max="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MajorBaseToleranceNegative))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MajorBaseTolerancePositive))_container" class="col-md-2">
                                            <label>
                                                @Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().MajorBaseTolerancePositive)
                                            </label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MajorBaseTolerancePositive))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().MajorBaseTolerancePositive)" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MajorBaseTolerancePositive))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MinorBase))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().MinorBase)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MinorBase))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().MinorBase)" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MinorBase))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MinorBaseToleranceNegative))_container" class="col-md-2">
                                            <label>
                                                @Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().MinorBaseToleranceNegative)
                                            </label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MinorBaseToleranceNegative))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().MinorBaseToleranceNegative)" max="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MinorBaseToleranceNegative))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MinorBaseTolerancePositive))_container" class="col-md-2">
                                            <label>
                                                @Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().MinorBaseTolerancePositive)
                                            </label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MinorBaseTolerancePositive))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().MinorBaseTolerancePositive)" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.MinorBaseTolerancePositive))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.TurnOver))_container" class="col-md-1">
                                            <label class="form-check-label"
                                                   for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.TurnOver))">
                                                @Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().TurnOver)
                                            </label>

                                            @* El label dentro de form-check para que al hacer clic active el checkbox *@
                                            @if (canEditSales)
                                            {
                                                <input class="form-check-input form-control"
                                                       type="checkbox"
                                                       id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.TurnOver))" />
                                            }
                                            else
                                            {
                                                <input class="form-check-input form-control"
                                                       type="checkbox"
                                                       id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.TurnOver))"
                                                       disabled="disabled" />
                                            }

                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.TurnOver))Error"
                                                  class="error-message"
                                                  style="color: red; display: none;">
                                            </span>
                                        </div>


                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.TurnOverSide))_container" class="col-md-2">
                                            <label for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.TurnOverSide))">
                                                @Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().TurnOverSide)
                                            </label>

                                            @if (canEditSales)
                                            {
                                                <select id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.TurnOverSide))"
                                                        name="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.TurnOverSide))"
                                                        class="form-control select2">
                                                    <option value="">Select an option</option>
                                                    <option value="Left">Left</option>
                                                    <option value="Right">Right</option>
                                                </select>
                                            }
                                            else
                                            {
                                                <select id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.TurnOverSide))"
                                                        name="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.TurnOverSide))"
                                                        class="form-control select2" disabled="disabled">
                                                    <option value="">Select an option</option>
                                                    <option value="Left">Left</option>
                                                    <option value="Right">Right</option>
                                                </select>
                                            }
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.TurnOverSide))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>

                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.IsWeldedBlank))_container" class="col-md-1">
                                            <label class="form-check-label"
                                                   for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.IsWeldedBlank))">
                                                @Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().IsWeldedBlank)
                                            </label>

                                            @* El label dentro de form-check para que al hacer clic active el checkbox *@
                                            @if (canEditSales)
                                            {
                                                <input class="form-check-input form-control"
                                                       type="checkbox"
                                                       id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.IsWeldedBlank))" />
                                            }
                                            else
                                            {
                                                <input class="form-check-input form-control"
                                                       type="checkbox"
                                                       id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.IsWeldedBlank))"
                                                       disabled="disabled" />
                                            }

                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.IsWeldedBlank))Error"
                                                  class="error-message"
                                                  style="color: red; display: none;">
                                            </span>
                                        </div>

                                        @*<div id="IsWeldedBlank_container" class="col-md-2 d-flex align-items-center">
                                                <div class="form-check custom-checkbox-container">
                                                    @if (canEditSales)
                                                    {
                                                    <input class="form-check-input" type="checkbox" id="IsWeldedBlank" @(canEditSales ? "" : "disabled")>
                                                    }else{
                                                    }
                                                    <label class="form-check-label" for="IsWeldedBlank">
                                                        Is Welded Blank?
                                                    </label>
                                                </div>
                                            </div>*@
                                        <div class="col-md-3" id="numberOfPlates_container" style="display: none;">
                                            <label for="numberOfPlates">Number of plates</label>
                                            <input type="number" id="numberOfPlates" class="form-control" placeholder="Enter number" min="2" @(canEditSales ? "" : "readonly") />

                                            <span id="numberOfPlatesError" class="error-message" style="color: red; display: none;"></span>
                                        </div>

                                        <div class="" id="weldedPlatesThickness_container" style="display: none;">
                                        </div>


                                        <div id="cat_file_container" class="col-md-4">
                                            <label>CAD Drawings (C)</label>
                                            <div class="col-md-12">
                                                <input type="file" id="archivo" name="archivo" accept=".dwg,.dxf,.dwt,.pdf,.rar,.zip" @(!canEditSales ? "disabled" : string.Empty)>
                                                <!-- Botón para cambiar archivo -->
                                                <button type="button" class="btn btn-danger btn-sm" id="cancelFileButton" style="display: none;" @(!canEditSales ? "disabled" : string.Empty)>Cancel</button>
                                            </div>
                                            <span id="CADFileError" class="error-message col-md-12" style="color: red; display: none;"></span>
                                        </div>
                                        <!-- Contenedor para las acciones sobre el archivo existente -->
                                        <div id="fileActions_container" class="col-md-4" style="display: none;">
                                            <label>CAD Drawings</label>
                                            <div class="col-md-12">
                                                <!-- Enlace para descargar; el href se asignará dinámicamente (o se puede generar en el servidor) -->
                                                <a id="downloadFile" href="#" class="truncate-filename">Descargar Archivo</a>
                                                <!-- Botón para cambiar archivo -->
                                                <button type="button" class="btn btn-success btn-sm" id="changeFileButton" @(!canEditSales ? "disabled" : string.Empty)>Change</button>
                                            </div>
                                        </div>

                                        <div id="file_container_technicalSheetFile" class="col-md-4">
                                            <label for="technicalSheetFile">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_File_TechnicalSheet)</label>
                                            <div class="col-md-12">
                                                <input type="file" id="technicalSheetFile" name="technicalSheetFile" accept=".dwg,.dxf,.dwt,.pdf,.rar,.zip" @(!canEditSales ? "disabled" : string.Empty)>
                                                <!-- Botón para cambiar archivo -->
                                                <button type="button" class="btn btn-danger btn-sm" id="technicalSheetFileCancelButton" style="display: none;" @(!canEditSales ? "disabled" : string.Empty)>Cancel</button>
                                            </div>
                                            <span id="technicalSheetFileError" class="error-message col-md-12" style="color: red; display: none;"></span>
                                        </div>
                                        <!-- Contenedor para las acciones sobre el archivo existente -->
                                        <div id="fileActions_containerTechnicalSheetFile" class="col-md-4" style="display: none;">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_File_TechnicalSheet)</label>
                                            <div class="col-md-12">
                                                <!-- Enlace para descargar; el href se asignará dinámicamente (o se puede generar en el servidor) -->
                                                <a id="downloadFileTechnicalSheetFile" href="#" class="truncate-filename">Download File</a>
                                                <!-- Botón para cambiar archivo -->
                                                <button type="button" class="btn btn-success btn-sm" id="changeFileButtonTechnicalSheetFile" @(!canEditSales ? "disabled" : string.Empty)>Change</button>
                                            </div>
                                        </div>

                                        <div id="file_container_AdditionalFile" class="col-md-4">
                                            <label for="AdditionalFile">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_File_Additional)</label>
                                            <div class="col-md-12">
                                                <input type="file" id="AdditionalFile" name="AdditionalFile" accept=".dwg,.dxf,.dwt,.pdf,.rar,.zip" @(!canEditSales ? "disabled" : string.Empty)>
                                                <!-- Botón para cambiar archivo -->
                                                <button type="button" class="btn btn-danger btn-sm" id="AdditionalFileCancelButton" style="display: none;" @(!canEditSales ? "disabled" : string.Empty)>Cancel</button>
                                            </div>
                                            <span id="AdditionalFileError" class="error-message col-md-12" style="color: red; display: none;"></span>
                                        </div>
                                        <!-- Contenedor para las acciones sobre el archivo existente -->
                                        <div id="fileActions_containerAdditionalFile" class="col-md-4" style="display: none;">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_File_Additional)</label>
                                            <div class="col-md-12">
                                                <!-- Enlace para descargar; el href se asignará dinámicamente (o se puede generar en el servidor) -->
                                                <a id="downloadFileAdditional" href="#" class="truncate-filename">Download File</a>
                                                <!-- Botón para cambiar archivo -->
                                                <button type="button" class="btn btn-success btn-sm" id="changeFileAdditional" @(!canEditSales ? "disabled" : string.Empty)>Change</button>
                                            </div>
                                        </div>


                                    </div>
                                </fieldset>

                                <!-- Volume -->
                                <fieldset class="mb-3">
                                    <legend>Volume</legend>
                                    <div class="row">

                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Annual_Volume))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Annual_Volume)</label>

                                            <input type="text"
                                                   inputmode="numeric"
                                                   pattern="[0-9]*"
                                                   oninput="this.value = this.value.replace(/[^0-9]/g, '')"
                                                   id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Annual_Volume))"
                                                   class="form-control"
                                                   placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Annual_Volume)"
                                                   min="0"
                                                   autocomplete="off"
                                                   @(canEditSales ? "" : "readonly") />

                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Annual_Volume))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Volume_Per_year))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Volume_Per_year)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Volume_Per_year))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Volume_Per_year)" min="0" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Volume_Per_year))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="WeightPerPart_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().WeightPerPart)</label>
                                            <input type="text" id="WeightPerPart" class="form-control" placeholder="Weight per Part" readonly />
                                            <span id="WeightPerPartError" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Initial_Weight))_container" class="col-md-2">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Initial_Weight)</label>
                                            <input type="text" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Initial_Weight))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Initial_Weight)" readonly />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Initial_Weight))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InitialWeightPerPart))_container" class="col-md-3">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().InitialWeightPerPart)</label>
                                            <input type="text" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InitialWeightPerPart))" class="form-control" placeholder="Calculated" readonly />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InitialWeightPerPart))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.AnnualTonnage))_container" class="col-md-2">
                                            <label for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.AnnualTonnage))">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().AnnualTonnage)</label>
                                            <input type="number" step="any"
                                                   id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.AnnualTonnage))"
                                                   class="form-control"
                                                   placeholder="Annual Tonnage"
                                                   readonly /> <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.AnnualTonnage))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>

                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ShippingTons))_container" class="col-md-3">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ShippingTons)</label>
                                            <input type="text" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ShippingTons))" class="form-control" placeholder="Calculated" readonly />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ShippingTons))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>

                                        <div id="file_container_volumeAdditionalFile" class="col-md-4">
                                            <label for="volumeAdditionalFile">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_File_VolumeAdditional)</label>
                                            <div class="col-md-12">
                                                <input type="file" id="volumeAdditionalFile" name="volumeAdditionalFile" accept=".dwg,.dxf,.dwt,.pdf,.rar,.zip" @(!canEditSales ? "disabled" : string.Empty)>
                                                <button type="button" class="btn btn-danger btn-sm" id="volumeAdditionalFileCancelButton" style="display: none;" @(!canEditSales ? "disabled" : string.Empty)>Cancel</button>
                                            </div>
                                            <span id="volumeAdditionalFileError" class="error-message col-md-12" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="fileActions_containerVolumeAdditionalFile" class="col-md-4" style="display: none;">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_File_VolumeAdditional)</label>
                                            <div class="col-md-12">
                                                <a id="downloadVolumeAdditionalFile" href="#" class="truncate-filename">Download File</a>
                                                <button type="button" class="btn btn-success btn-sm" id="changeFileVolumeAdditionalFile" @(!canEditSales ? "disabled" : string.Empty)>Change</button>
                                            </div>
                                        </div>
                                    </div>
                                </fieldset>


                                <!-- Delivery Packaging -->
                                <fieldset class="mb-3">
                                    <legend>Delivery Packaging</legend>

                                    <div class="row">
                                        <div class="col-md-3" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Delivery_Coil_Position))_container">
                                            <label for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Delivery_Coil_Position))">
                                                @Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_Delivery_Coil_Position)
                                            </label>
                                            @if (canEditSales)
                                            {
                                                @Html.DropDownList(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Delivery_Coil_Position), (SelectList)ViewBag.CoilPositionList, "Select an option", new { @class = "form-control select2" })
                                            }
                                            else
                                            {
                                                @Html.DropDownList(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Delivery_Coil_Position), (SelectList)ViewBag.CoilPositionList, "Select an option", new { @class = "form-control select2", disabled = "disabled" })
                                            }
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Delivery_Coil_Position))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div class="col-md-3 form-group" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Delivery_Transport_Type))_container">
                                            <label for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Delivery_Transport_Type))">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_Delivery_Transport_Type)</label>
                                            @if (canEditSales)
                                            {
                                                @Html.DropDownList(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Delivery_Transport_Type), (SelectList)ViewBag.ArrivalTransportTypeList, "Select an option", new { @class = "form-control select2" })
                                            }
                                            else
                                            {
                                                @Html.DropDownList(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Delivery_Transport_Type), (SelectList)ViewBag.ArrivalTransportTypeList, "Select an option", new { @class = "form-control select2", disabled = "disabled" })
                                            }
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Delivery_Transport_Type))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div class="col-md-3" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Delivery_Transport_Type_Other))_container" style="display: none;">
                                            <label for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Delivery_Transport_Type_Other))">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Delivery_Transport_Type_Other)</label>
                                            <input type="text" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Delivery_Transport_Type_Other))" class="form-control"
                                                   placeholder="Specify transport..." maxlength="50"
                                                   @(canEditSales ? "" : "readonly") autocomplete="off" />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Delivery_Transport_Type_Other))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div class="col-md-4">
                                            <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.PackagingStandard))_container" class="form-group">
                                                <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().PackagingStandard)</label>
                                                <select id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.PackagingStandard))" class="form-control select2" @(!canEditSales ? "disabled" : string.Empty)>
                                                    <option value="">Select an option</option>
                                                    <option value="OWN">Developed by tkMM</option>
                                                    <option value="CM">Provided by Client</option>
                                                </select>
                                                <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.PackagingStandard))Error" class="error-message" style="color: red; display: none;"></span>
                                            </div>
                                        </div>
                                        <div class="col-md-3 d-flex align-items-center" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.RequiresRackManufacturing))_container" style="display: none;">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.RequiresRackManufacturing))" @(!canEditSales ? "disabled" : "")>
                                                <label class="form-check-label" for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.RequiresRackManufacturing))">
                                                    @Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().RequiresRackManufacturing)
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-3 d-flex align-items-center" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.RequiresDieManufacturing))_container" style="display: none;">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.RequiresDieManufacturing))" @(!canEditSales ? "disabled" : "")>
                                                <label class="form-check-label" for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.RequiresDieManufacturing))">
                                                    @Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().RequiresDieManufacturing)
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-3" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.PiecesPerPackage))_container">
                                            <label for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.PiecesPerPackage))">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().PiecesPerPackage)</label>
                                            <input type="number" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.PiecesPerPackage))" class="form-control" placeholder="Qty" min="0" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.PiecesPerPackage))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div class="col-md-3" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.StacksPerPackage))_container">
                                            <label for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.StacksPerPackage))">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().StacksPerPackage)</label>
                                            <input type="number" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.StacksPerPackage))" class="form-control" placeholder="Qty" min="0" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.StacksPerPackage))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div class="col-md-3" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.PackageWeight))_container">
                                            <label for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.PackageWeight))">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().PackageWeight)</label>
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.PackageWeight))" class="form-control" placeholder="Package Weight" readonly />
                                            <small class="form-text text-muted">
                                                <i>Note: Weight does not include the rack or packaging materials.</i>
                                            </small>
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.PackageWeight))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div class="col-md-8">
                                            <div id="packaging-file-div_container" class="form-group">
                                                <div id="packaging_file_container">
                                                    <label>Packaging Drawing / Standard</label>
                                                    <input type="file" id="packaging_archivo" name="packaging_archivo" accept=".dwg,.dxf,.dwt,.pdf,.rar,.zip" @(!canEditSales ? "disabled" : string.Empty)>
                                                    <span id="PackagingFileError" class="error-message" style="color: red; display: none;"></span>
                                                </div>
                                                <div id="packagingFileActions_container" style="display: none;">
                                                    <label>Packaging Drawing / Standard</label>
                                                    <div>
                                                        <a id="downloadPackagingFile" href="#" class="truncate-filename">Download File</a>
                                                        <button type="button" class="btn btn-success btn-xs" id="changePackagingFileButton" @(!canEditSales ? "disabled" : string.Empty)>Change</button>
                                                        <button type="button" class="btn btn-danger btn-xs" id="cancelPackagingFileButton" style="display: none;">Cancel</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="file_container_deliveryPackagingAdditionalFile" class="col-md-4">
                                            <label for="deliveryPackagingAdditionalFile">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_File_DeliveryPackagingAdditional)</label>
                                            <div class="col-md-12">
                                                <input type="file" id="deliveryPackagingAdditionalFile" name="deliveryPackagingAdditionalFile" accept=".dwg,.dxf,.dwt,.pdf,.rar,.zip" @(!canEditSales ? "disabled" : string.Empty)>
                                                <button type="button" class="btn btn-danger btn-sm" id="deliveryPackagingAdditionalFileCancelButton" style="display: none;" @(!canEditSales ? "disabled" : string.Empty)>Cancel</button>
                                            </div>
                                            <span id="deliveryPackagingAdditionalFileError" class="error-message col-md-12" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="fileActions_containerDeliveryPackagingAdditionalFile" class="col-md-4" style="display: none;">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_File_DeliveryPackagingAdditional)</label>
                                            <div class="col-md-12">
                                                <a id="downloadDeliveryPackagingAdditionalFile" href="#" class="truncate-filename">Download File</a>
                                                <button type="button" class="btn btn-success btn-sm" id="changeFileDeliveryPackagingAdditionalFile" @(!canEditSales ? "disabled" : string.Empty)>Change</button>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row packaging-row" style="margin-top: 15px;">
                                        <div id="rack-types-group_container" class="col-md-6 checkbox-group-container">
                                            <label>Rack Types</label>
                                            <div class="group-content-wrapper">
                                                <div id="rack-types-container" class="checkbox-options-wrapper">
                                                    @foreach (var rackType in (SelectList)ViewBag.RackTypeList)
                                                    {
                                                        <div class="form-check form-check-inline">
                                                            <input class="form-check-input rack-type-checkbox" type="checkbox" id="rack-type-@rackType.Value" value="@rackType.Value" @(!canEditSales ? "disabled" : "")>
                                                            <label class="form-check-label" for="rack-type-@rackType.Value">@rackType.Text</label>
                                                        </div>
                                                    }
                                                </div>
                                            </div>
                                        </div>
                                        <div id="labels-group_container" class="col-md-6 checkbox-group-container">
                                            <label>Labels</label>
                                            <div class="group-content-wrapper">
                                                <div id="labels-container" class="checkbox-options-wrapper">
                                                    @foreach (var item in (SelectList)ViewBag.LabelList)
                                                    {
                                                        <div class="form-check form-check-inline">
                                                            <input class="form-check-input label-checkbox" type="checkbox" id="label-@item.Value" value="@item.Value" @(!canEditSales ? "disabled" : "")>
                                                            <label class="form-check-label" for="label-@item.Value">@item.Text</label>
                                                        </div>
                                                    }
                                                </div>
                                                <div id="LabelOtherDescription_container" class="other-description-wrapper" style="display: none;">
                                                    <label for="LabelOtherDescription" class="observation-label">Specify "Other" Label</label>
                                                    <textarea id="LabelOtherDescription" class="form-control form-control-sm" rows="1" @(!canEditSales ? "readonly" : "")></textarea>
                                                    <span id="LabelOtherDescriptionError" class="error-message" style="color: red; display: none;"></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-2" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.IsReturnableRack))_container">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.IsReturnableRack))" @(canEditSales ? "" : "disabled")>
                                                <label class="form-check-label" for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.IsReturnableRack))">
                                                    @Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().IsReturnableRack)
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-3" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ReturnableUses))_container" style="display: none;">
                                            <label for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ReturnableUses))">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ReturnableUses)</label>
                                            <input type="number" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ReturnableUses))" class="form-control" placeholder="e.g., 5" min="0" @(canEditSales ? "" : "readonly") />
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ReturnableUses))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                    </div>

                                    <div class="row packaging-row" style="margin-top: 15px;">
                                        <div id="additionals-group_container" class="col-md-6 checkbox-group-container">
                                            <label>Additionals</label>
                                            <div class="group-content-wrapper">
                                                <div id="additionals-container" class="checkbox-options-wrapper">
                                                    @foreach (var item in (SelectList)ViewBag.AdditionalList)
                                                    {
                                                        <div class="form-check form-check-inline">
                                                            <input class="form-check-input additional-checkbox" type="checkbox" id="additional-@item.Value" value="@item.Value" @(!canEditSales ? "disabled" : "")>
                                                            <label class="form-check-label" for="additional-@item.Value">@item.Text</label>
                                                        </div>
                                                    }
                                                </div>
                                                <div id="AdditionalsOtherDescription_container" class="other-description-wrapper" style="display: none;">
                                                    <label for="AdditionalsOtherDescription" class="observation-label">Specify "Other" Additional</label>
                                                    <textarea id="AdditionalsOtherDescription" class="form-control form-control-sm" rows="1" @(!canEditSales ? "readonly" : "")></textarea>
                                                    <span id="AdditionalsOtherDescriptionError" class="error-message" style="color: red; display: none;"></span>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="straps-group_container" class="col-md-6 checkbox-group-container">
                                            <label>Standard Packaging</label>
                                            <div class="group-content-wrapper">
                                                <div id="straps-container" class="checkbox-options-wrapper">
                                                    @foreach (var item in (SelectList)ViewBag.StrapTypeList)
                                                    {
                                                        <div class="form-check form-check-inline">
                                                            <input class="form-check-input strap-checkbox" type="checkbox" id="strap-@item.Value" value="@item.Value" @(!canEditSales ? "disabled" : "")>
                                                            <label class="form-check-label" for="strap-@item.Value">@item.Text</label>
                                                        </div>
                                                    }
                                                </div>
                                                <div class="other-description-wrapper">
                                                    <label for="StrapTypeObservations" class="observation-label">Observations</label>
                                                    <textarea id="StrapTypeObservations" class="form-control form-control-sm" rows="1" placeholder="Strap type observations..." @(!canEditSales ? "readonly" : "")></textarea>
                                                    <span id="StrapTypeObservationsError" class="error-message" style="color: red; display: none;"></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <hr />
                                    <div class="row" style="margin-top:15px;">
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.SpecialRequirement))_container" class="col-md-6">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().SpecialRequirement)</label>
                                            <textarea id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.SpecialRequirement))" class="form-control" rows="3" @(canEditSales ? "" : "readonly")></textarea>
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.SpecialRequirement))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.SpecialPackaging))_container" class="col-md-6">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().SpecialPackaging)</label>
                                            <textarea id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.SpecialPackaging))" class="form-control" rows="3" @(canEditSales ? "" : "readonly")></textarea>
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.SpecialPackaging))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                    </div>
                                </fieldset>

                                <!-- Outbound Freight & Conditions -->
                                <fieldset class="mb-3">
                                    <legend>Outbound Freight & Conditions</legend>

                                    <div class="row">
                                        <div class="col-md-3" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_FreightType))_container">
                                            <label for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_FreightType))">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_FreightType)</label>
                                            @if (canEditSales)
                                            {
                                                @Html.DropDownList(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_FreightType), (SelectList)ViewBag.FreightTypeList, "Select an option", new { @class = "form-control select2" })
                                            }
                                            else
                                            {
                                                @Html.DropDownList(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_FreightType), (SelectList)ViewBag.FreightTypeList, "Select an option", new { @class = "form-control select2", disabled = "disabled" })
                                            }
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_FreightType))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                        <div class="col-md-9" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.DeliveryConditions))_container">
                                            <label for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.DeliveryConditions))">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().DeliveryConditions)</label>
                                            <textarea id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.DeliveryConditions))" class="form-control" rows="1" placeholder="Describe delivery conditions..." @(canEditSales ? "" : "readonly")></textarea>
                                            <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.DeliveryConditions))Error" class="error-message" style="color: red; display: none;"></span>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-2 d-flex align-items-center">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ScrapReconciliation))" @(canEditSales ? "" : "disabled")>
                                                <label class="form-check-label" for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ScrapReconciliation))">
                                                    @Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ScrapReconciliation)
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-9" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ScrapReconciliationPercent))_container" style="display: none;">
                                            <div class="row">
                                                <div id="ScrapReconciliationPercent_Min_container" class="col-md-3">
                                                    <label for="ScrapReconciliationPercent_Min">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ScrapReconciliationPercent_Min)</label>
                                                    <input type="number" step="any" id="ScrapReconciliationPercent_Min" class="form-control" placeholder="Min %" min="0" max="100" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                                    <span id="ScrapReconciliationPercent_MinError" class="error-message" style="color: red; display: none;"></span>
                                                </div>
                                                <div id="ScrapReconciliationPercent_Optimal_container" class="col-md-3">
                                                    <label for="ScrapReconciliationPercent">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ScrapReconciliationPercent)</label>
                                                    <input type="number" step="any" id="ScrapReconciliationPercent" class="form-control" placeholder="Optimal %" min="0" max="100" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                                    <span id="ScrapReconciliationPercentError" class="error-message" style="color: red; display: none;"></span>
                                                </div>
                                                <div id="ScrapReconciliationPercent_Max_container" class="col-md-3">
                                                    <label for="ScrapReconciliationPercent_Max">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ScrapReconciliationPercent_Max)</label>
                                                    <input type="number" step="any" id="ScrapReconciliationPercent_Max" class="form-control" placeholder="Max %" min="0" max="100" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                                    <span id="ScrapReconciliationPercent_MaxError" class="error-message" style="color: red; display: none;"></span>
                                                </div>
                                                <div id="ClientScrapReconciliationPercent_container" class="col-md-3">
                                                    <label for="ClientScrapReconciliationPercent">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ClientScrapReconciliationPercent)</label>
                                                    <input type="number" step="any" id="ClientScrapReconciliationPercent" class="form-control" placeholder="Client %" min="0" max="100" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                                    <span id="ClientScrapReconciliationPercentError" class="error-message" style="color: red; display: none;"></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">

                                        <div class="col-md-2 d-flex align-items-center">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.HeadTailReconciliation))" @(canEditSales ? "" : "disabled")>
                                                <label class="form-check-label" for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.HeadTailReconciliation))">
                                                    @Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().HeadTailReconciliation)
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-9" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.HeadTailReconciliationPercent))_container" style="display: none;">
                                            <div class="row">
                                                <div id="HeadTailReconciliationPercent_Min_container" class="col-md-3">
                                                    <label for="HeadTailReconciliationPercent_Min">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().HeadTailReconciliationPercent_Min)</label>
                                                    <input type="number" step="any" id="HeadTailReconciliationPercent_Min" class="form-control" placeholder="Min %" min="0" max="100" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                                    <span id="HeadTailReconciliationPercent_MinError" class="error-message" style="color: red; display: none;"></span>
                                                </div>
                                                <div id="HeadTailReconciliationPercent_Optimal_container" class="col-md-3">
                                                    <label for="HeadTailReconciliationPercent">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().HeadTailReconciliationPercent)</label>
                                                    <input type="number" step="any" id="HeadTailReconciliationPercent" class="form-control" placeholder="Optimal %" min="0" max="100" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                                    <span id="HeadTailReconciliationPercentError" class="error-message" style="color: red; display: none;"></span>
                                                </div>
                                                <div id="HeadTailReconciliationPercent_Max_container" class="col-md-3">
                                                    <label for="HeadTailReconciliationPercent_Max">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().HeadTailReconciliationPercent_Max)</label>
                                                    <input type="number" step="any" id="HeadTailReconciliationPercent_Max" class="form-control" placeholder="Max %" min="0" max="100" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                                    <span id="HeadTailReconciliationPercent_MaxError" class="error-message" style="color: red; display: none;"></span>
                                                </div>
                                                <div id="ClientHeadTailReconciliationPercent_container" class="col-md-3">
                                                    <label for="ClientHeadTailReconciliationPercent">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ClientHeadTailReconciliationPercent)</label>
                                                    <input type="number" step="any" id="ClientHeadTailReconciliationPercent" class="form-control" placeholder="Client %" min="0" max="100" autocomplete="off" @(canEditSales ? "" : "readonly") />
                                                    <span id="ClientHeadTailReconciliationPercentError" class="error-message" style="color: red; display: none;"></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div id="file_container_outboundFreightAdditionalFile" class="col-md-4">
                                            <label for="outboundFreightAdditionalFile">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_File_OutboundFreightAdditional)</label>
                                            <div class="col-md-12">
                                                <input type="file" id="outboundFreightAdditionalFile" name="outboundFreightAdditionalFile" accept=".dwg,.dxf,.dwt,.pdf,.rar,.zip" @(!canEditSales ? "disabled" : string.Empty)>
                                                <button type="button" class="btn btn-danger btn-sm" id="outboundFreightAdditionalFileCancelButton" style="display: none;" @(!canEditSales ? "disabled" : string.Empty)>Cancel</button>
                                            </div>
                                            <span id="outboundFreightAdditionalFileError" class="error-message col-md-12" style="color: red; display: none;"></span>
                                        </div>
                                        <div id="fileActions_containerOutboundFreightAdditionalFile" class="col-md-4" style="display: none;">
                                            <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_File_OutboundFreightAdditional)</label>
                                            <div class="col-md-12">
                                                <a id="downloadOutboundFreightAdditionalFile" href="#" class="truncate-filename">Download File</a>
                                                <button type="button" class="btn btn-success btn-sm" id="changeFileOutboundFreightAdditionalFile" @(!canEditSales ? "disabled" : string.Empty)>Change</button>
                                            </div>
                                        </div>
                                    </div>
                                </fieldset>

                                @if (ViewBag.RequiresInterplant) // Solo mostrar si el proyecto es Interplanta
                                {
                                    <fieldset class="mb-3" id="interplantDeliveryFieldset">
                                        <legend>
                                            Interplant Delivery Packaging
                                        </legend>

                                        <div class="row">

                                            <div class="col-md-3" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_InterplantDelivery_Coil_Position))_container">
                                                <label for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_InterplantDelivery_Coil_Position))">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_InterplantDelivery_Coil_Position)</label>
                                                @* Usamos el ViewBag.CoilPositionList existente *@
                                                @Html.DropDownList(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_InterplantDelivery_Coil_Position), (SelectList)ViewBag.CoilPositionList, "Select an option", new { @class = "form-control select2" })
                                                <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_InterplantDelivery_Coil_Position))Error" class="error-message" style="color: red; display: none;"></span>
                                            </div>
                                            <div class="col-md-3 form-group" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_InterplantDelivery_Transport_Type))_container">
                                                <label for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_InterplantDelivery_Transport_Type))">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_InterplantDelivery_Transport_Type)</label>
                                                @* Usamos el ViewBag.ArrivalTransportTypeList existente *@
                                                @Html.DropDownList(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_InterplantDelivery_Transport_Type), (SelectList)ViewBag.ArrivalTransportTypeList, "Select an option", new { @class = "form-control select2" })
                                                <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_InterplantDelivery_Transport_Type))Error" class="error-message" style="color: red; display: none;"></span>
                                            </div>
                                            <div class="col-md-3" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantDelivery_Transport_Type_Other))_container" style="display: none;">
                                                <label for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantDelivery_Transport_Type_Other))">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().InterplantDelivery_Transport_Type_Other)</label>
                                                <input type="text" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantDelivery_Transport_Type_Other))" name="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantDelivery_Transport_Type_Other))" class="form-control" placeholder="Specify transport..." maxlength="50" autocomplete="off" />
                                                <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantDelivery_Transport_Type_Other))Error" class="error-message" style="color: red; display: none;"></span>
                                            </div>
                                            <div class="col-md-4">
                                                <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantPackagingStandard))_container" class="form-group">
                                                    <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().InterplantPackagingStandard)</label>
                                                    <select id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantPackagingStandard))" name="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantPackagingStandard))" class="form-control select2">
                                                        <option value="">Select an option</option>
                                                        <option value="OWN">Developed by tkMM</option>
                                                        <option value="CM">Provided by Client</option>
                                                    </select>
                                                    <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantPackagingStandard))Error" class="error-message" style="color: red; display: none;"></span>
                                                </div>
                                            </div>

                                            <div class="col-md-3 d-flex align-items-center" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantRequiresRackManufacturing))_container" style="display: none;">
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantRequiresRackManufacturing))" name="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantRequiresRackManufacturing))" value="true" @(!canEditSales ? "disabled" : "")>
                                                    <label class="form-check-label" for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantRequiresRackManufacturing))">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().InterplantRequiresRackManufacturing)</label>
                                                </div>
                                            </div>
                                            <div class="col-md-3 d-flex align-items-center" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantRequiresDieManufacturing))_container" style="display: none;">
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantRequiresDieManufacturing))" name="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantRequiresDieManufacturing))" value="true" @(!canEditSales ? "disabled" : "")>
                                                    <label class="form-check-label" for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantRequiresDieManufacturing))">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().InterplantRequiresDieManufacturing)</label>
                                                </div>
                                            </div>
                                            <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantPiecesPerPackage))_container" class="col-md-3">
                                                <label for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantPiecesPerPackage))">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().InterplantPiecesPerPackage)</label>
                                                <input type="number"
                                                       id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantPiecesPerPackage))"
                                                       name="materials[0].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantPiecesPerPackage))" @* Note: Name attribute might need dynamic index if edited directly in the form, but often relies on hidden fields. Using index 0 as placeholder. *@
                                                       class="form-control" placeholder="Qty" min="0" @(canEditSales ? "" : "readonly") autocomplete="off" />
                                                <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantPiecesPerPackage))Error" class="error-message" style="color: red; display: none;"></span>
                                            </div>

                                            <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantStacksPerPackage))_container" class="col-md-3">
                                                <label for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantStacksPerPackage))">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().InterplantStacksPerPackage)</label>
                                                <input type="number"
                                                       id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantStacksPerPackage))"
                                                       name="materials[0].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantStacksPerPackage))" @* Placeholder name *@
                                                       class="form-control" placeholder="Qty" min="0" @(canEditSales ? "" : "readonly") autocomplete="off" />
                                                <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantStacksPerPackage))Error" class="error-message" style="color: red; display: none;"></span>
                                            </div>

                                            <div id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantPackageWeight))_container" class="col-md-3">
                                                <label for="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantPackageWeight))">@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().InterplantPackageWeight)</label>
                                                <input type="number" step="any"
                                                       id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantPackageWeight))" @* ID matches label 'for' *@
                                                       name="materials[0].@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantPackageWeight))" @* Placeholder name *@
                                                       class="form-control" placeholder="Package Weight" readonly />
                                                <small class="form-text text-muted"><i>Note: Weight does not include the rack or packaging materials.</i></small>
                                                <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantPackageWeight))Error" class="error-message" style="color: red; display: none;"></span>
                                            </div>
                                            <div class="col-md-8">
                                                <div id="interplant-packaging-file-div_container" class="form-group">
                                                    <div id="interplant_packaging_file_container">
                                                        <label>Interplant Packaging Drawing / Standard</label>
                                                        <input type="file" id="interplant_packaging_archivo" name="interplant_packaging_archivo" accept=".dwg,.dxf,.dwt,.pdf,.rar,.zip">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row packaging-row" style="margin-top: 15px;">
                                            <div id="interplant-rack-types-group_container" class="col-md-6 checkbox-group-container">
                                                <label>Interplant Rack Types</label>
                                                <div class="group-content-wrapper">
                                                    <div id="interplant-rack-types-container" class="checkbox-options-wrapper">
                                                        @* Iterate through the SAME ViewBag as the normal Rack Types *@
                                                        @foreach (var rackType in (SelectList)ViewBag.RackTypeList)
                                                        {
                                                            <div class="form-check form-check-inline">
                                                                <input class="form-check-input interplant-rack-type-checkbox" type="checkbox"
                                                                       id="interplant-rack-type-@rackType.Value" value="@rackType.Value"
                                                                       @(!canEditSales ? "disabled" : "")> @* Apply disabled based on permission *@
                                                                    <label class="form-check-label" for="interplant-rack-type-@rackType.Value">@rackType.Text</label>
                                                                </div>
                                                            }
                                                    </div>
                                                </div>
                                            </div>
                                            <div id="interplant-labels-group_container" class="col-md-6 checkbox-group-container">
                                                <label>Interplant Labels</label>
                                                <div class="group-content-wrapper">
                                                    <div id="interplant-labels-container" class="checkbox-options-wrapper">
                                                        @foreach (var item in (SelectList)ViewBag.LabelList)
                                                        {
                                                            <div class="form-check form-check-inline">
                                                                <input class="form-check-input" type="checkbox" id="interplant-label-@item.Value" value="@item.Value">
                                                                <label class="form-check-label" for="interplant-label-@item.Value">@item.Text</label>
                                                            </div>
                                                        }
                                                    </div>
                                                    <div id="InterplantLabelOtherDescription_container" class="other-description-wrapper" style="display: none;">
                                                        <label for="InterplantLabelOtherDescription" class="observation-label">Specify "Other" Label</label>
                                                        <textarea id="InterplantLabelOtherDescription" class="form-control form-control-sm" rows="1"></textarea>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-md-2" id="InterplantIsReturnableRack_container">
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="InterplantIsReturnableRack">
                                                    <label class="form-check-label" for="InterplantIsReturnableRack">Returnable Rack</label>
                                                </div>
                                            </div>
                                            <div class="col-md-3" id="InterplantReturnableUses_container" style="display: none;">
                                                <label for="InterplantReturnableUses">Number of Uses</label>
                                                <input type="number" id="InterplantReturnableUses" class="form-control" placeholder="e.g., 5" min="0" />
                                            </div>
                                        </div>

                                        <div class="row packaging-row" style="margin-top: 15px;">
                                            <div id="interplant-additionals-group_container" class="col-md-6 checkbox-group-container">
                                                <label>Interplant Additionals</label>
                                                <div class="group-content-wrapper">
                                                    <div id="interplant-additionals-container" class="checkbox-options-wrapper">
                                                        @foreach (var item in (SelectList)ViewBag.AdditionalList)
                                                        {
                                                            <div class="form-check form-check-inline">
                                                                <input class="form-check-input" type="checkbox" id="interplant-additional-@item.Value" value="@item.Value">
                                                                <label class="form-check-label" for="interplant-additional-@item.Value">@item.Text</label>
                                                            </div>
                                                        }
                                                    </div>
                                                    <div id="InterplantAdditionalsOtherDescription_container" class="other-description-wrapper" style="display: none;">
                                                        <label for="InterplantAdditionalsOtherDescription" class="observation-label">Specify "Other" Additional</label>
                                                        <textarea id="InterplantAdditionalsOtherDescription" class="form-control form-control-sm" rows="1"></textarea>
                                                    </div>
                                                </div>
                                            </div>
                                            <div id="interplant-straps-group_container" class="col-md-6 checkbox-group-container">
                                                <label>Interplant Standard Packaging</label>
                                                <div class="group-content-wrapper">
                                                    <div id="interplant-straps-container" class="checkbox-options-wrapper">
                                                        @foreach (var item in (SelectList)ViewBag.StrapTypeList)
                                                        {
                                                            <div class="form-check form-check-inline">
                                                                <input class="form-check-input" type="checkbox" id="interplant-strap-@item.Value" value="@item.Value">
                                                                <label class="form-check-label" for="interplant-strap-@item.Value">@item.Text</label>
                                                            </div>
                                                        }
                                                    </div>
                                                    <div class="other-description-wrapper">
                                                        <label for="InterplantStrapTypeObservations" class="observation-label">Observations</label>
                                                        <textarea id="InterplantStrapTypeObservations" class="form-control form-control-sm" rows="1" placeholder="Strap type observations..."></textarea>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <hr />
                                        <div class="row" style="margin-top:15px;">
                                            <div id="InterplantSpecialRequirement_container" class="col-md-6">
                                                <label>Interplant Special Requirement</label>
                                                <textarea id="InterplantSpecialRequirement" class="form-control" rows="3"></textarea>
                                            </div>
                                            <div id="InterplantSpecialPackaging_container" class="col-md-6">
                                                <label>Interplant Special Packaging</label>
                                                <textarea id="InterplantSpecialPackaging" class="form-control" rows="3"></textarea>
                                            </div>
                                        </div>
                                    </fieldset>
                                }
                                <fieldset class="mb-3">
                                    <legend>
                                        Interplant Outbound Freight & Conditions
                                    </legend>

                                    <div class="row">
                                        <div class="col-md-3" id="ID_InterplantFreightType_container">
                                            <label for="ID_InterplantFreightType">Interplant Freight Type</label>
                                            @Html.DropDownList("ID_InterplantFreightType", (SelectList)ViewBag.FreightTypeList, "Select an option", new { @class = "form-control select2" })
                                        </div>
                                        <div class="col-md-9" id="InterplantDeliveryConditions_container">
                                            <label for="InterplantDeliveryConditions">Interplant Delivery Conditions</label>
                                            <textarea id="InterplantDeliveryConditions" class="form-control" rows="1" placeholder="Describe interplant delivery conditions..."></textarea>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-2 d-flex align-items-center">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="InterplantScrapReconciliation">
                                                <label class="form-check-label" for="InterplantScrapReconciliation">
                                                    Scrap Reconciliation
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-9" id="InterplantScrapReconciliationPercent_container" style="display: none;">
                                            <div class="row">
                                                <div id="InterplantScrapReconciliationPercent_Min_container" class="col-md-3">
                                                    <label for="InterplantScrapReconciliationPercent_Min">Min %</label>
                                                    <input type="number" step="any" id="InterplantScrapReconciliationPercent_Min" class="form-control" placeholder="Min %" min="0" max="100" autocomplete="off" />
                                                </div>
                                                <div id="InterplantScrapReconciliationPercent_Optimal_container" class="col-md-3">
                                                    <label for="InterplantScrapReconciliationPercent">Optimal %</label>
                                                    <input type="number" step="any" id="InterplantScrapReconciliationPercent" class="form-control" placeholder="Optimal %" min="0" max="100" autocomplete="off" />
                                                </div>
                                                <div id="InterplantScrapReconciliationPercent_Max_container" class="col-md-3">
                                                    <label for="InterplantScrapReconciliationPercent_Max">Max %</label>
                                                    <input type="number" step="any" id="InterplantScrapReconciliationPercent_Max" class="form-control" placeholder="Max %" min="0" max="100" autocomplete="off" />
                                                </div>
                                                <div id="InterplantClientScrapReconciliationPercent_container" class="col-md-3">
                                                    <label for="InterplantClientScrapReconciliationPercent">Client %</label>
                                                    <input type="number" step="any" id="InterplantClientScrapReconciliationPercent" class="form-control" placeholder="Client %" min="0" max="100" autocomplete="off" />
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-2 d-flex align-items-center">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="InterplantHeadTailReconciliation">
                                                <label class="form-check-label" for="InterplantHeadTailReconciliation">
                                                    Head/Tail Reconciliation
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-9" id="InterplantHeadTailReconciliationPercent_container" style="display: none;">
                                            <div class="row">
                                                <div id="InterplantHeadTailReconciliationPercent_Min_container" class="col-md-3">
                                                    <label for="InterplantHeadTailReconciliationPercent_Min">Min %</label>
                                                    <input type="number" step="any" id="InterplantHeadTailReconciliationPercent_Min" class="form-control" placeholder="Min %" min="0" max="100" autocomplete="off" />
                                                </div>
                                                <div id="InterplantHeadTailReconciliationPercent_Optimal_container" class="col-md-3">
                                                    <label for="InterplantHeadTailReconciliationPercent">Optimal %</label>
                                                    <input type="number" step="any" id="InterplantHeadTailReconciliationPercent" class="form-control" placeholder="Optimal %" min="0" max="100" autocomplete="off" />
                                                </div>
                                                <div id="InterplantHeadTailReconciliationPercent_Max_container" class="col-md-3">
                                                    <label for="InterplantHeadTailReconciliationPercent_Max">Max %</label>
                                                    <input type="number" step="any" id="InterplantHeadTailReconciliationPercent_Max" class="form-control" placeholder="Max %" min="0" max="100" autocomplete="off" />
                                                </div>
                                                <div id="InterplantClientHeadTailReconciliationPercent_container" class="col-md-3">
                                                    <label for="InterplantClientHeadTailReconciliationPercent">Client %</label>
                                                    <input type="number" step="any" id="InterplantClientHeadTailReconciliationPercent" class="form-control" placeholder="Client %" min="0" max="100" autocomplete="off" />
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div id="file_container_interplantOutboundFreightAdditionalFile" class="col-md-4">
                                            <label for="interplantOutboundFreightAdditionalFile">Interplant Additional File</label>
                                            <div class="col-md-12">
                                                <input type="file" id="interplantOutboundFreightAdditionalFile" name="interplantOutboundFreightAdditionalFile" accept=".dwg,.dxf,.dwt,.pdf,.rar,.zip">
                                            </div>
                                        </div>
                                    </div>
                                </fieldset>


                                <br />
                                <button type="button" class="btn btn-success btn-xs btn-add-material" style="display:@(!canEditSales?"none":string.Empty)"><i class="fa-solid fa-plus"></i> Add Material</button>
                                <button type="button" class="btn btn-danger btn-xs btn-clear-form" style="display:@(!canEditSales?"none":string.Empty)"><i class="fa-solid fa-eraser"></i> Clear Form</button>
                            </div>

                            <!-- SECCIÓN DE INPUTS: material-form -->
                            <div class="material-form">
                                <!-- TITLE FOR THE MATERIAL FORM -->
                                <div class="material-form-title">Technical Feasibility</div>
                                <div class="row">
                                    <div class="col-md-3">
                                        <input type="hidden" id="ID_Theoretical_Blanking_Line" name="ID_Theoretical_Blanking_Line" />
                                        <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_Theoretical_Blanking_Line)</label>
                                        <input type="text" id="theoretical_blk_line" class="form-control" placeholder="Theoretical Blanking Line" readonly />
                                    </div>
                                    <div class="col-md-3">
                                        <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Theoretical_Strokes)</label>
                                        <input type="text" id="Theoretical_Strokes" class="form-control" placeholder="Theoretical Strokes" readonly />
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-3">
                                        <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_Real_Blanking_Line)</label>
                                        @if (canEditEngineering)
                                        {
                                            @Html.DropDownList("ID_Real_Blanking_Line", (SelectList)ViewBag.LinesList, "Select Line", new { @class = "form-control select2" })
                                        }
                                        else
                                        {
                                            @Html.DropDownList("ID_Real_Blanking_Line", (SelectList)ViewBag.LinesList, "Select Line", new { @class = "form-control select2", disabled = "disabled" })
                                        }
                                        <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Real_Blanking_Line))Error" class="error-message" style="color: red; display: none;"></span>
                                    </div>
                                    <div class="col-md-3">
                                        <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Real_Strokes)</label>
                                        <input type="text" id="Real_Strokes" class="form-control" placeholder="Real Strokes" readonly />
                                    </div>

                                </div>
                                <div class="row">
                                    <div class="col-md-3">
                                        <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Ideal_Cycle_Time_Per_Tool)</label>
                                        <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Ideal_Cycle_Time_Per_Tool))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Ideal_Cycle_Time_Per_Tool)" min="0" autocomplete="off" @(canEditEngineering ? "" : "readonly") />
                                        <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Ideal_Cycle_Time_Per_Tool))Error" class="error-message" style="color: red; display: none;"></span>
                                    </div>
                                    <div class="col-md-3">
                                        <label>@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().OEE)</label>
                                        <div style="position: relative; display: inline-block; width: 100%;">
                                            <input type="number" step="any" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.OEE))" class="form-control" placeholder="@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().OEE)" min="0" max="100" style="padding-right: 25px;text-align:right" autocomplete="off" @(canEditEngineering ? "" : "readonly") />
                                            <span style="position: absolute; right: 10px; top: 44%; transform: translateY(-50%); pointer-events: none; color: #555; font-weight: bold;">%</span>

                                        </div>
                                        <span id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.OEE))Error" class="error-message" style="color: red; display: none;"></span>
                                        <small id="oeeCalculationNote" class="form-text text-muted" style="display:none; font-style: italic;"></small>

                                    </div>
                                </div>

                                <div class="row">
                                    <div id="TonsPerShift_container" class="col-md-3">
                                        <label>Tons per shift</label>
                                        <input type="number" step="any" id="TonsPerShift" name="TonsPerShift" class="form-control" placeholder="Tons per shift" min="0" autocomplete="off" @(canEditEngineering ? "" : "readonly") />
                                        <span id="TonsPerShiftError" class="error-message" style="color: red; display: none;"></span>
                                    </div>

                                    <div id="SlittingLine_container" class="col-md-3">
                                        <label>Slitting Line</label>
                                        <select id="ID_Slitting_Line" name="ID_Slitting_Line" class="form-control select2" @(!canEditEngineering ? "disabled" : "")>
                                            <option value="">Select a slitting line</option>
                                        </select>
                                        <span id="ID_Slitting_LineError" class="error-message" style="color: red; display: none;"></span>
                                    </div>
                                </div>
                                <br />
                                <button type="button" class="btn btn-success btn btn-add-material" id="id-btn-save-engineering" style="display:none"><i class="fa-solid fa-save"></i> Save Changes</button>
                            </div>

                            <!-- SECCIÓN DE INPUTS: material-form -->
                            <div class="material-form">
                                <!-- TITLE FOR THE MATERIAL FORM -->
                                <div class="material-form-title">Efficiency and Capacity</div>
                                <div class="row">
                                    <div class="col-md-3" style="display:@(!canEditDataManagement?"none":string.Empty)">
                                        <label>Parts/Auto</label>
                                        <input type="text" id="parts_auto" class="form-control" placeholder="Parts/Auto" readonly />
                                    </div>
                                    <div class="col-md-3" style="display:@(!canEditDataManagement?"none":string.Empty)">
                                        <label>Stroke/Auto</label>
                                        <input type="text" id="strokes_auto" class="form-control" placeholder="Stroke/Auto" readonly />
                                    </div>
                                    <div class="col-md-3" style="display:@(!canEditDataManagement?"none":string.Empty)">
                                        <label>Blanks/Year</label>
                                        <input type="text" id="blanks_per_year" class="form-control" placeholder="Blanks/Year" readonly />
                                    </div>
                                    <div class="col-md-3" style="display:@(!canEditDataManagement?"none":string.Empty)">
                                        <label>Min Max Reales</label>
                                        <input type="text" id="min_max_reales" class="form-control" placeholder="Min Max Reales" readonly />
                                    </div>
                                    <div class="col-md-3" style="display:@(!canEditDataManagement?"none":string.Empty)">
                                        <label>Min Max Reales / OEE</label>
                                        <input type="text" id="min_max_reales_oee" class="form-control" placeholder="Min Max Reales / OEE" readonly />
                                    </div>
                                    <div class="col-md-3" style="display:@(!canEditDataManagement?"none":string.Empty)">
                                        <label>Actual Shifts</label>
                                        <input type="text" id="actual_shifts" class="form-control" placeholder="Actual Shifts" readonly />
                                    </div>
                                    <div class="col-md-3" style="display:@(!canEditDataManagement?"none":string.Empty)">
                                        <label>Stroke / shift</label>
                                        <input type="text" id="strokes_shift" class="form-control" placeholder="Stroke / shift" readonly />
                                    </div>
                                    <div class="col-md-3">
                                        <label>Status DM</label>
                                        <input type="text" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.DM_status))" class="form-control" placeholder="Status DM" readonly />
                                    </div>
                                    <div class="col-md-6">
                                        <label>&emsp;</label>
                                        <span class="form-control" style="font-weight:bold; background-color:#f4f4f4; border: 0px;" id="@(nameof(Portal_2_0.Models.CTZ_Project_Materials.DM_status_comment))"></span>
                                    </div>

                                </div>
                                <label> Project's Impact on Line Capacity</label>
                                <!-- Contenedor para el Handsontable de "What‑If Capacity" para el material seleccionado -->
                                <div id="capacityTableContainer"></div>
                                <div style="margin-bottom: 10px;display:@(!canEditDataManagement?"none":string.Empty);">
                                    <strong>Color Legend:</strong>
                                    <div style="display: flex; gap: 20px; margin-top: 5px;">
                                        <div style="display: flex; align-items: center;">
                                            <div style="width: 20px; height: 20px; background-color: #c1fcac; border: 1px solid #ccc; margin-right: 5px;"></div>
                                            <span> < 95% (ACCEPTED)</span>
                                        </div>
                                        <div style="display: flex; align-items: center;">
                                            <div style="width: 20px; height: 20px; background-color: #ffd53b; border: 1px solid #ccc; margin-right: 5px; "></div>
                                            <span>95% to 98% (ON REVIEWED)</span>
                                        </div>
                                        <div style="display: flex; align-items: center;">
                                            <div style="width: 20px; height: 20px; background-color: #ff7c4f; border: 1px solid #ccc; margin-right: 5px;"></div>
                                            <span>> 98% (REJECTED)</span>
                                        </div>
                                    </div>
                                </div>
                                <label>Summary Capacity</label>
                                <div id="chartsContainer"></div>
                                <div id="slitterChartContainer" style="display:none; margin-top: 20px;">
                                    <hr>
                                    <h4 class="text-center">Slitter Capacity Utilization</h4>
                                </div>
                                <!-- LEGEND: leyenda de turnos fuera del canvas -->
                                <div id="shiftLegend" class="mt-3 text-center"></div>
                            </div>


                            <!-- Botón final para guardar todo en la base de datos -->
                            @*<button type="submit" class="btn btn-success"><i class="fa-regular fa-floppy-disk"></i> Save All Materials</button>*@
                        }
                    </div>
                    <div class="text-right mt-3">
                        <button type="button"
                                class="btn btn-default"
                                onclick="window.location='@Url.Action("EditProject", "CTZ_Projects", new { id = Model.ID_Project })'">
                            <i class="fa-regular fa-circle-left"></i> Back
                        </button>
                    </div>
            </div>
        </div>

    </div>
</div>
</div>

<div id="loadingOverlay" style="
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-color: rgba(0, 0, 0, 0.4);
    z-index: 10000;
">
    <div style="
        position: absolute;
        top: 20px;
        left:30px;
        color: #b0a9a9;
        font-size: 1.8em;
        font-weight: bold;
        background-color: rgba(0, 0, 0, 0.5);
        padding: 10px 20px;
        border-radius: 6px;
    ">
        <i class="fa-solid fa-spinner fa-spin"></i> Guardando Cambios...
    </div>
</div>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")

    <!-- SweetAlert2 -->
    @Scripts.Render(Url.Content("~/Content/vendors/sweetalert2/sweetalert2.min.js"))
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <!-- Select2 -->
    @Scripts.Render(Url.Content("~/Content/vendors/select2/js/select2.full.min.js"))
    <!-- DatePicker -->
    @Scripts.Render(Url.Content("~/Content/vendors/moment/moment.js"))
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
    <!-- Hansontable -->
    <script src="https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.js"></script>
    <!-- ChartJS -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@1.1.0"></script>
    <script>
        // Objeto de configuración global para toda la página
        window.pageConfig = {
            // URLs generadas por Razor que tus JS puros necesitarán
            urls: {
                getSlitterLines: '@Url.Action("GetSlitterLines", "CTZ_Projects")',
                getIHSByCountry: '@Url.Action("GetIHSByCountry", "CTZ_Projects")',
                getCountryForIHS: '@Url.Action("GetCountryForIHS", "CTZ_Projects")',
                getTheoreticalLine: '@Url.Action("GetTheoreticalLine", "CTZ_Projects")',
                getEngineeringDimensions: '@Url.Action("GetEngineeringDimensions", "CTZ_Projects")',
                getOeeForLine: '@Url.Action("GetOeeForLine", "CTZ_Projects")',
                getMaterialCapacityScenariosGraphs: '@Url.Action("GetMaterialCapacityScenariosGraphs", "CTZ_Projects")',
                GetMaterialCapacityScenarios: '@Url.Action("GetMaterialCapacityScenarios", "CTZ_Projects")',
                GetSlitterCapacityData: '@Url.Action("GetSlitterCapacityData", "CTZ_Projects")',
                validateLineForMaterial: '@Url.Action("ValidateLineForMaterial", "CTZ_Projects")',
                getMaterialTypesForSlitter: '@Url.Action("GetAvailableMaterialTypesForSlitter", "CTZ_Projects")',
                getTheoreticalStrokes: '@Url.Action("GetTheoreticalStrokes", "CTZ_Projects")',

            },
            // Selectores de campos (para reemplazar todos los @@nameof)
            fieldSelectors: {
                Vehicle: "#Vehicle",
                Vehicle_2: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Vehicle_2))",
                Vehicle_3: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Vehicle_3))",
                Vehicle_4: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Vehicle_4))",
                Vehicle_version: "#vehicleVersion",
                Part_Name: "#partName",
                Part_Number: "#partNumber",
                Quality: "#quality",
                SOP_SP: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.SOP_SP))",
                EOP_SP: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.EOP_SP))",
                Real_SOP: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Real_SOP))",
                Real_EOP: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Real_EOP))",
                Ship_To: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Ship_To))",
                ID_Route: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Route))",
                Tensile_Strenght: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Tensile_Strenght))",
                ID_Material_type: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Material_type))",
                Thickness: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Thickness))",
                ThicknessToleranceNegative: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ThicknessToleranceNegative))",
                ThicknessTolerancePositive: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ThicknessTolerancePositive))",
                Width: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width))",
                WidthToleranceNegative: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.WidthToleranceNegative))",
                WidthTolerancePositive: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.WidthTolerancePositive))",
                Pitch: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Pitch))",
                Gross_Weight: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Gross_Weight))",
                Annual_Volume: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Annual_Volume))",
                Volume_Per_year: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Volume_Per_year))",
                ID_Shape: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Shape))",
                Angle_A: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Angle_A))",
                Angle_B: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Angle_B))",
                Blanks_Per_Stroke: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Blanks_Per_Stroke))",
                Parts_Per_Vehicle: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Parts_Per_Vehicle))",
                ID_Real_Blanking_Line: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Real_Blanking_Line))",
                ID_Theoretical_Blanking_Line: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Theoretical_Blanking_Line))",
                Theoretical_Strokes: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Theoretical_Strokes))",
                Real_Strokes: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Real_Strokes))",
                Ideal_Cycle_Time_Per_Tool: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Ideal_Cycle_Time_Per_Tool))",
                OEE: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.OEE))",
                TonsPerShift: "#TonsPerShift",
                DM_status: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.DM_status))",
                DM_status_comment: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.DM_status_comment))",
                // ... (Agrega TODOS tus selectores de @@nameof aquí)
                // Tolerancias

                // ... etc.
                // Packaging
                PackagingStandard: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.PackagingStandard))",
                RequiresRackManufacturing: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.RequiresRackManufacturing))",
                RequiresDieManufacturing: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.RequiresDieManufacturing))",
                // ... etc.
                // Interplant (los nuevos)
                ID_Interplant_Plant: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Interplant_Plant))",
                ID_InterplantDelivery_Coil_Position: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_InterplantDelivery_Coil_Position))",
                ID_InterplantDelivery_Transport_Type: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_InterplantDelivery_Transport_Type))",
                InterplantDelivery_Transport_Type_Other: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantDelivery_Transport_Type_Other))",
                InterplantPackagingStandard: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantPackagingStandard))",
                InterplantRequiresRackManufacturing: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantRequiresRackManufacturing))",
                InterplantRequiresDieManufacturing: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantRequiresDieManufacturing))",
                PiecesPerPackage : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.PiecesPerPackage))",
                Shearing_Width : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Width))",
                Shearing_Width_Tol_Pos : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Width_Tol_Pos))",
                Shearing_Width_Tol_Neg : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Width_Tol_Neg))",
                Shearing_Pitch : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pitch))",
                Shearing_Pitch_Tol_Pos : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pitch_Tol_Pos))",
                Shearing_Pitch_Tol_Neg : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pitch_Tol_Neg))",
                Shearing_Weight : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Weight))",
                Shearing_Weight_Tol_Pos: "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Weight_Tol_Pos))",
                Shearing_Weight_Tol_Neg : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Weight_Tol_Neg))",
                Shearing_Pieces_Per_Stroke : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pieces_Per_Stroke))",
                Shearing_Pieces_Per_Car : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Shearing_Pieces_Per_Car))",
                ClientScrapReconciliationPercent : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ClientScrapReconciliationPercent))",
                ClientHeadTailReconciliationPercent : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ClientHeadTailReconciliationPercent))",
                WeightOfFinalMults : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.WeightOfFinalMults))",
                WeightOfFinalMults_Min : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.WeightOfFinalMults_Min))",
                WeightOfFinalMults_Max : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.WeightOfFinalMults_Max))",
                ScrapReconciliationPercent_Min : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ScrapReconciliationPercent_Min))",
                ScrapReconciliationPercent : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ScrapReconciliationPercent))",
                ScrapReconciliationPercent_Max : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ScrapReconciliationPercent_Max))",
                ScrapReconciliation : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ScrapReconciliation))",
                HeadTailReconciliationPercent_Min : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.HeadTailReconciliationPercent_Min))",
                HeadTailReconciliationPercent : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.HeadTailReconciliationPercent))",
                HeadTailReconciliationPercent_Max : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.HeadTailReconciliationPercent_Max))",
                HeadTailReconciliation : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.HeadTailReconciliation))",
                ClientNetWeight : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ClientNetWeight))",
                ID_FreightType : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_FreightType))",
                ID_Arrival_Warehouse : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.ID_Arrival_Warehouse))",
                StacksPerPackage : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.StacksPerPackage))",
                DeliveryConditions : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.DeliveryConditions))",
                Arrival_Transport_Type_Other : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Arrival_Transport_Type_Other))",
                Width_Mults : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Mults))",
                Width_Mults_Tol_Neg : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Mults_Tol_Neg))",
                Width_Mults_Tol_Pos : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Mults_Tol_Pos))",
                Width_Plates : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Plates))",
                Width_Plates_Tol_Neg : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Plates_Tol_Neg))",
                Width_Plates_Tol_Pos : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.Width_Plates_Tol_Pos))",
                TurnOverSide : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.TurnOverSide))",
                TurnOver : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.TurnOver))",
                InterplantPiecesPerPackage : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantPiecesPerPackage))",
                InterplantStacksPerPackage : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantStacksPerPackage))",
                InterplantPackageWeight : "#@(nameof(Portal_2_0.Models.CTZ_Project_Materials.InterplantPackageWeight))",

            },
            displayNames: {
                ID_Route : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_Route)",
                ID_Material_type : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_Material_type)",
                ID_Shape : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ID_Shape)",
                PackagingStandard : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().PackagingStandard)",
                Tensile_Strenght : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Tensile_Strenght)",
                Thickness : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Thickness)",
                ThicknessToleranceNegative : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ThicknessToleranceNegative)",
                ThicknessTolerancePositive : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().ThicknessTolerancePositive)",
                WidthToleranceNegative : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().WidthToleranceNegative)",
                WidthTolerancePositive : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().WidthTolerancePositive)",
                PitchToleranceNegative : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().PitchToleranceNegative)",
                PitchTolerancePositive : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().PitchTolerancePositive)",
                AngleAToleranceNegative : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().AngleAToleranceNegative)",
                AngleATolerancePositive : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().AngleATolerancePositive)",
                AngleBToleranceNegative : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().AngleBToleranceNegative)",
                AngleBTolerancePositive : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().AngleBTolerancePositive)",
                WeightOfFinalMults : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().WeightOfFinalMults)",
                Multipliers : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Multipliers)",
                MajorBase : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().MajorBase)",
                MajorBaseToleranceNegative : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().MajorBaseToleranceNegative)",
                MajorBaseTolerancePositive : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().MajorBaseTolerancePositive)",
                MinorBase : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().MinorBase)",
                MinorBaseToleranceNegative : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().MinorBaseToleranceNegative)",
                MinorBaseTolerancePositive : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().MinorBaseTolerancePositive)",
                Flatness : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Flatness)",
                FlatnessToleranceNegative : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().FlatnessToleranceNegative)",
                FlatnessTolerancePositive : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().FlatnessTolerancePositive)",
                MasterCoilWeight : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().MasterCoilWeight)",
                InnerCoilDiameterArrival : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().InnerCoilDiameterArrival)",
                OuterCoilDiameterArrival : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().OuterCoilDiameterArrival)",
                InnerCoilDiameterDelivery : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().InnerCoilDiameterDelivery)",
                OuterCoilDiameterDelivery : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().OuterCoilDiameterDelivery)",
                Width : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Width)",
                Pitch : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Pitch)",
                Gross_Weight : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Gross_Weight)",
                Annual_Volume : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Annual_Volume)",
                Volume_Per_year : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Volume_Per_year)",
                Angle_A : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Angle_A)",
                Angle_B : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Angle_B)",
                Blanks_Per_Stroke : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Blanks_Per_Stroke)",
                Parts_Per_Vehicle : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Parts_Per_Vehicle)",
                Ship_To : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().Ship_To)",
                SpecialPackaging : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().SpecialPackaging)",
                SpecialRequirement : "@Html.DisplayNameFor(model => model.CTZ_Project_Materials.First().SpecialRequirement)",
            },
            // Datos del proyecto y estado
            project: {
                id: @Model.ID_Project,
                plantId: @Model.ID_Plant,
                statusId: @Model.ID_Status,
                vehicleType: @(Model.ID_VehicleType.HasValue ? Model.ID_VehicleType.Value : 0),
                requiresInterplant: @(ViewBag.RequiresInterplant.ToString().ToLower()),
                hasExternalProcessor: @(Model.HasExternalProcessor ? "true" : "false"),
                externalProcessorId: @(Model.ID_ExternalProcessor ?? 0),
                successMessage: @Html.Raw(Json.Encode(TempData["SuccessMessage"])),
            },
            // Permisos
            permissions: {
                isDetailsMode: @isDetailsMode.ToString().ToLower(),
                canEditSales: @canEditSales.ToString().ToLower(),
                canEditDataManagement: @canEditDataManagement.ToString().ToLower(),
                canEditEngineering: @canEditEngineering.ToString().ToLower()
            },
            // Listas y datos (ej. para validaciones)
            lists: {
                materialTypes: @Html.Raw(Json.Encode(ViewBag.MaterialTypeList)),
                qualityList: @Html.Raw(Json.Encode(ViewBag.QualityList))
            },
            statusIDs: {
                Quotes: @((int)Bitacoras.Util.CTZ_Project_Estatus_Enum.Quotes),
                CarryOver: @((int)Bitacoras.Util.CTZ_Project_Estatus_Enum.CarryOver),
                CasiCasi: @((int)Bitacoras.Util.CTZ_Project_Estatus_Enum.CasiCasi),
                POH: @((int)Bitacoras.Util.CTZ_Project_Estatus_Enum.POH)
                // Agrega cualquier otro estatus que uses
            }
        };
    </script>
    @Scripts.Render("~/bundles/EditClientPartInfo")

    <script>

        

    $(document).ready(function () {

    
      
    });

    </script>
}
